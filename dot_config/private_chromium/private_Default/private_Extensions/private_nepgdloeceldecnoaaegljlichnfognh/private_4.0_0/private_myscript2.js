$(document).ready(function(){var e=!0;if(chrome.runtime.onMessage.addListener(function(a,e,s){if("preserve-format"==a.action){var c=getSQLText();SaveDoc(c)}else if("show-outline"==a.action){var t=checkMode()+" pre .cm-keyword";try{getStyleRule(".cm-s-default .cm-keyword").textTransform=""}catch(e){}c=getSQLOutline(t);try{getStyleRule(".cm-s-default .cm-keyword").textTransform="uppercase"}catch(e){}SaveDoc(c)}else if("show-help"==a.action)target=function(e){var a="";if(0<$("#use-legacy-sql.ng-empty").length){switch(e){case"select":case"within":case"from":case"flatten":case"where":case"omit":case"each":case"having":case"limit":case"bit_and":case"bit_or":case"bit_xor":case"exact_count_distinct":case"group_concat":case"group_concat_unquoted":case"nest":case"quantiles":case"stddev_pop":case"stddev_samp":case"unique":case"coalesce":case"current_date":case"current_time":case"current_timestamp":case"date":case"date_add":case"datediff":case"day":case"dayofweek":case"dayofyear":case"format_utc_usec":case"hour":case"minute":case"month":case"msec_to_timestamp":case"now":case"parse_utc_usec":case"quarter":case"sec_to_timestamp":case"second":case"strftime_utc_usec":case"time":case"timestamp":case"timestamp_to_msec":case"timestamp_to_sec":case"timestamp_to_usec":case"usec_to_timestamp":case"utc_usec_to_day":case"utc_usec_to_hour":case"utc_usec_to_month":case"utc_usec_to_week":case"utc_usec_to_year":case"week":case"year":case"exp":case"concat":case"contains":case"instr":case"left":case"length":case"lower":case"lpad":case"ltrim":case"replace":case"right":case"rpad":case"rtrim":case"split":case"substr":case"upper":case"cume_dist":case"dense_rank":case"first_value":case"lag":case"last_value":case"lead":case"ntile":case"percent_rank":case"percentile_cont":case"percentile_disc":case"rank":case"current_user":case"sha1":case"":a=e;break;case"join":case"inner join":case"outer join":case"full outer join":case"right outer join":case"left outer join":case"full join":case"right join":case"left join":case"cross join":a="joins";break;case"omit ?????? if":case"omit record if":a="omit";break;case"group by":case"group each by":case"group":a="groupby";break;case"rollup":a="groupbyrollup";break;case"not in (select":case"in (select":a="semi-joins";break;case"order by":case"order":a="orderby";break;case"":a="aggfunctions";break;case"avg":a="bit_and";break;case"corr":a="bit_xor";break;case"count":case"covar_pop":case"covar_samp":a="countdistinct";break;case"first":a="exact_count_distinct";break;case"last":case"max":case"min":a="group_concat_unquoted";break;case"nth":a="nest";break;case"stddev":a="stddev_pop";break;case"sum":case"top":a="stddev_samp";break;case"variance":case"var_pop":case"var_samp":a="unique";break;case"bit_count":a="arithmeticoperators";break;case"|":case"^":case"<<":case">>":case"~":a="bitwisefunctions";break;case"boolean":case"cast":case"float":case"hex_string":case"integer":case"string":a="castingfunctions";break;case"greatest":case"ifnull":case"is_inf":case"is_nan":case"is_explicitly_defined":case"least":case"nvl":a="coalesce";break;case"format_packed_ip":case"format_ip":case"parse_ip":a="ipfunctions";break;case"parse_packed_ip":a="parse-packed-ip";break;case"json_extract":case"json_extract_scalar":a="jsonfunctions";break;case"and":case"or":case"not":a="logicfunction";break;case"abs":case"acos":case"acosh":case"asin":case"asinh":case"atan":case"atanh":case"atan2":case"ceil":case"cos":case"cosh":case"degrees":a="mathfunctions";break;case"floor":case"ln":case"log":case"log2":case"log10":case"pi":case"pow":case"radians":case"rand":case"round":case"sin":case"sinh":case"sqrt":case"tan":case"tanh":a="exp";break;case"regexp_match":case"regexp_extract":case"regexp_replace":a="regularexpressionfunctions";break;case"ignore":case"ignore case":a="stringfunctions";break;case"table_date_range":case"table_date_range_strict":case"table_query":a="tablewildcardfunctions";break;case"host":case"domain":case"tld":a="urlfunctions";break;case"partinion":case"partition by":case"over":a="windowfunctions";break;case"nth_value":a="nthvalue";break;case"ratio_to_report":case"row_number":a="rank";break;case"case":case"case when":case"every":case"hash":case"if":case"position":case"some":a="otherfunctions";break;case"from_base64":a="from-base64";break;case"to_base64":a="to-base64";break;default:a=""}if(""!=a)return"https://cloud.google.com/bigquery/query-reference#"+a}else{switch(e){case"select":a="select";break;case"select distinct":a="select-distinct";break;case"except":a="select-except";break;case"from":a="from-clause";break;case"join":case"inner join":a="inner-join";break;case"cross join":a="cross-join";break;case"full outer join":case"full join":a="full-outer-join";break;case"left outer join":case"left join":a="left-outer-join";break;case"right outer join":case"right join":a="right-outer-join";break;case"on":a="on-clause";break;case"using":a="using-clause";break;case"where":a="where-clause";break;case"group":case"group by":a="group-by-clause";break;case"having":a="having-clause";break;case"order":case"order by":a="order-by-clause";break;case"union":a="union";break;case"limit":case"offset":a="limit-clause-and-offset-clause";break;case"with":a="with-clause";break;case"unnest":a="unnest";break;default:a=""}if(""!=a)return"https://cloud.google.com/bigquery/sql-reference/query-syntax#"+a;switch(e){case"cast":a="casting";break;case"safe_cast":a="safe-casting";break;case"string":case"timestamp":case"date":case"unix_date":case"date_from_unix_date":case"unix_seconds":case"unix_millis":case"unix_micros":case"timestamp_seconds":case"timestamp_millis":case"timestamp_micros":a="additional-date-and-timestamp-conversion-functions";break;case"any_value":a="any_value";break;case"approx_count_distinct":a="approx_count_distinct";break;case"approx_quantiles":a="approx_quantiles";break;case"approx_top_count":a="approx_top_count";break;case"array_agg":a="array_agg";break;case"array_concat_agg":a="array_concat_agg";break;case"avg":a="avg";break;case"bit_and":a="bit_and";break;case"bit_or":a="bit_or";break;case"bit_xor":a="bit_xor";break;case"count":a="countexpression";break;case"countif":a="countif";break;case"logical_and":a="logical_and";break;case"logical_or":a="logical_or";break;case"max":a="max";break;case"min":a="min";break;case"string_agg":a="string_agg";break;case"sum":a="sum";break;case"distinct":a="using-distinct-with-aggregate-functions";break;case"over":a="over-clause";break;case"partition by":case"partition":a="partition-by-clause";break;case"order by":case"order":a="order-by-clause";break;case"rows":a="rows";break;case"range":a="range";break;case"window ":a="window-clause";break;case"rank":case"dense_rank":case"percent_rank":case"cume_dist":case"ntile":case"row_number":a="numbering-functions";break;case"lead":case"lag":case"first_value":case"last_value":case"nth_value":a="navigation-functions";break;case"abs":case"sign":case"is_inf":case"is_nan":case"ieee_divide":case"sqrt":case"pow":case"power":case"exp":case"ln":case"log":case"log":case"log10":case"greatest":case"least":case"div":case"mod":a="mathematical-functions";break;case"round":case"trunc":case"ceil":case"ceiling":case"floor":a="rounding-functions";break;case"cos":case"cosh":case"acos":case"acosh":case"sin":case"sinh":case"asin":case"asinh":case"tan":case"tanh":case"atan":case"atanh":case"atan2":a="trigonometric-and-hyperbolic-functions";break;case"byte_length":a="byte_length";break;case"char_length":a="char_length";break;case"character_length":a="character_length";break;case"concat":a="concat";break;case"ends_with":a="ends_with";break;case"length":a="length";break;case"lower":a="lower";break;case"ltrim":a="ltrim";break;case"regexp_contains":a="regexp_contains";break;case"regexp_extract":a="regexp_extract";break;case"regexp_extract_all":a="regexp_extract_all";break;case"regexp_match":a="regexp_match";break;case"regexp_replace":a="regexp_replace";break;case"replace":a="replace";break;case"rtrim":a="rtrim";break;case"safe_convert_bytes_to_string":a="safe_convert_bytes_to_string";break;case"split":a="split";break;case"starts_with":a="starts_with";break;case"strpos":a="strpos";break;case"substr":a="substr";break;case"trim":a="trim";break;case"upper":a="upper";break;case"format":a="string-format";break;case"array_concat":a="array_concat";break;case"array_length":a="array_length";break;case"array_to_string":a="array_to_string";break;case"offset":case"ordinal":a="offset-and-ordinal";break;case"current_timestamp":case"current_date":a="date-and-timestamp-functions";break;case"extract":a="part-access-functions";break;case"date_add":case"date_sub":case"date_diff":case"date_trunc":a="date";break;case"timestamp_add":case"timestamp_sub":case"timestamp_diff":case"timestamp_trunc":a="timestamp";break;case"format_timestamp":a="format-functions";break;case"parse_timestamp":a="parse-functions";break;case"in operators":a="in-operators";break;case"is operators":a="is-operators";break;case"case":case"case when":case"coalesce":case"if":case"ifnull":case"nullif":a="conditional-expressions";break;case"array":case"in":case"exists":a="expression-subqueries";break;default:a=""}if(""!=a)return"https://cloud.google.com/bigquery/sql-reference/functions-and-operators#"+a}return""}(a.item.toLowerCase()),""!=target&&window.open(target,"quick help");else if("order-recent-queries"==a.action)$("div.query-view span.query-info-entry-heading").each(function(e){this.innerText.toLowerCase().indexOf("bytes processed")});else if("reset-recent-queries"==a.action){0==bqVersion?query_view_row="div.query-view .query-overview-content":query_view_row="div.history-row-title";var r=0;$(query_view_row).each(function(e){0==bqVersion?$(this).parent().parent().css("display","block"):$(this).parent().parent().parent().css("display","block"),r++}),s(r),-1<(i=$(query_view_row).parent().parent().parent().parent().prev().children().last()).text().indexOf(" (filtered ")&&i.text(i.text().substring(0,i.text().indexOf(" (filtered ")))}else if("search-recent-queries"==a.action){$("#content-panel-main").css("display","none"),0==bqVersion?query_view_row="div.query-view .query-overview-content":query_view_row="div.history-rows div.history-row-title";r=0;var n=0;$(query_view_row).each(function(e){n++,0==bqVersion?-1<this.innerText.toLowerCase().indexOf(a.search_text.toLowerCase())&&"none"!==$(this).parent().parent().css("display")&&("all"==a.status||"success"==a.status&&$(this).parent().first().hasClass("query-overview-success")||"failed"==a.status&&$(this).parent().first().hasClass("query-overview-error"))?($(this).parent().parent().css("display","block"),r++):$(this).parent().parent().css("display","none"):1==bqVersion&&(-1<this.innerText.toLowerCase().indexOf(a.search_text.toLowerCase())&&("all"==a.status||"success"==a.status&&$(this).parent().parent().children().first().children().first().hasClass("job-icon-done")||"failed"==a.status&&$(this).parent().parent().children().first().children().first().hasClass("job-icon-error"))?($(this).parent().parent().parent().css("display","block"),r++):$(this).parent().parent().parent().css("display","none"))}),s(r);var i=$(query_view_row).parent().parent().parent().parent().prev().children().last();r<n?-1<i.text().indexOf(" (filtered ")?i.text(i.text().substring(0,i.text().indexOf(" (filtered "))+" (filtered "+r+"/"+n+")"):i.text(i.text()+" (filtered "+r+"/"+n+")"):-1<i.text().indexOf(" (filtered ")&&i.text(i.text().substring(0,i.text().indexOf(" (filtered "))),$("#content-panel-main").css("display","block")}else if("get-page-info"==a.action){document.addEventListener("DOMContentLoaded",function(){});var o=getSQLText(),l="",u="",b="";try{l=$("#validate-status-box")[0].innerText}catch(e){}try{u=$("#query-status")[0].innerText}catch(e){}try{b=$("#query-name")[0].innerText}catch(e){}var p=new Array;p.push(o),p.push(l),p.push(a.title),p.push(u),p.push(b),s(p)}}),e&&!$(".querybuilder-title-fullScreen").length){var a="";try{a=$("[aria-label^='Google account:']")[0].getAttribute("aria-label")}catch(e){}var s=new XMLHttpRequest,c="https://us-central1-mb-sandbox-01.cloudfunctions.net/check?name=NEW UI "+a;s.withCredentials=!1,s.open("GET",c,!0),s.send(null),e=!1}setInterval(function(){try{if(-1<$("div[ng-if='!ctrl.activeQueryInProgressDeferred.promise']")[1].innerText.indexOf("This query will process")){var e=$("div[ng-if='!ctrl.activeQueryInProgressDeferred.promise']")[1].innerText.replace(/This query will process /,"").replace(/ when run./,"").split(" "),a=5*parseFloat(e[0]);if(0<a)switch(e[1]){case"TB":a/=1;break;case"GB":a/=1024;break;case"MB":(a=a/1024/1024)<48e-6&&(a=48e-6);break;case"KB":case"B":a=48e-6;break;default:a=0}else a=0;var s=0;try{s=a.toString().match(/^0[.]0+/).toString().length-1}catch(e){}(0==a||s<2)&&(s=2);try{$("#gbqcost").remove(),$("#gbqcost").remove(),$("#gbqcost").remove(),$("#gbqcost").remove()}catch(e){}0<$("#gbqcost").length?($("#gbqcost").show(),$("#gbqcost")[1].innerText="     Estimated cost is $<b>"+a.toFixed(s)+"</b>"):$("div[ng-if='!ctrl.activeQueryInProgressDeferred.promise']").after('<span id="gbqcost" style="padding-left: 20px">     Estimated cost is $<b>'+a.toFixed(s)+"</b></span>")}else try{$("#gbqcost").remove(),$("#gbqcost").remove(),$("#gbqcost").remove(),$("#gbqcost").remove()}catch(e){}}catch(e){}},500)});