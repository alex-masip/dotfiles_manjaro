var Chron=function(){var n,t={},e=i.prototype;function i(e,a){return this.constructor!==i?n||new i(e,a):n||(n=this,this.fps(e||25),void(t.running=!a))}return t.current=[],t.pending=[],t.doing={},t.funcs=[],t.handles=[],t.handleGen=0,t.active=!1,t.ticking=!1,t.running=null,t.fps=null,t.wait=null,t.startTick=function(){t.running&&!t.ticking&&(t.ticking=!0,t.interval=window.setTimeout(t.tick,t.wait))},t.tick=function(){if(t.running){var n,e,i,a,c,u,r=t.current,s=t.pending,l=t.funcs,h=t.handles,f=t.doing;for(t.active=!0,e=(n=Date.now())+t.wait;n<e&&r.length;n=Date.now())(a=f[i=r.shift()])&&(n<a.wait?s.push(i):(u=a.func(),a.repeat--?(a.wait=a.interval+e,s.push(i)):a.check&&u!==a.checkVal?(a.repeat=0,s.push(i)):(c=l.indexOf(a.func),l.splice(c,1),h.splice(c,1),delete f[i])));t.current=r=r.concat(s),t.pending=[],t.active=!1,r.length?t.interval=window.setTimeout(t.tick,Date.now()-e):t.ticking=!1}else t.ticking=!1},e.fps=function(n){return n&&(t.fps=Math.max(1,Math.min(60,isNaN(n)?25:n)),t.wait=1e3/t.fps>>0),t.fps},e.length=function(){return _funcs.length},e.running=function(){return _running},e.do=function(n,e,i,a){var c=t.funcs.indexOf(n),u=t.handles[c],r=isNaN(e)?0:Math.max(0,e),s=isNaN(i)?0:Math.max(0,i),l=isNaN(a)?0:Math.max(0,a);-1===c&&(c=t.funcs.length,u=++t.handleGen);var h={handle:u,wait:r+Date.now(),func:n,check:!1,repeat:s,interval:l};return t.funcs[c]=n,t.handles[c]=u,t.doing[u]=h,t.active?t.pending.push(u):t.current.push(u),t.startTick(),u},e.doUntil=function(n,e,i,a){var c=t.funcs.indexOf(n),u=t.handles[c],r=isNaN(i)?0:Math.max(0,i),s=isNaN(a)?0:Math.max(0,a);-1===c&&(c=t.funcs.length,u=++t.handleGen);var l={handle:u,wait:r+Date.now(),func:n,check:!0,checkVal:e,repeat:0,interval:s};return t.funcs[c]=n,t.handles[c]=u,t.doing[u]=l,t.active?t.pending.push(u):t.current.push(u),t.startTick(),u},e.getHandle=function(n){return t.handles[t.funcs.indexOf(n)]||null},e.clear=function(n){var e;!isNaN(n)&&(e=t.handles.indexOf(n))>-1&&(t.handles.splice(e,1),t.funcs.splice(e,1),delete t.doing[n])},e.stop=function(){t.running=!1},e.start=function(){t.running=!0,t.startTick()},i}();