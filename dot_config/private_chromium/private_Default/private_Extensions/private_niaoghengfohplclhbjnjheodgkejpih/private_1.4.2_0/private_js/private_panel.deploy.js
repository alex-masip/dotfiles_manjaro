var Stylomatic=function(){Object.__identseed__||(Object.__identseed__=1);var e={},t=r.prototype,n=r;function r(t){if(!(this instanceof r))return new r(t);Object.defineProperty(this,"__ident__",{value:Object.__identseed__++});var n=e[this.__ident__]={};if(t&&t.constructor===CSSStyleSheet){n.sheet=t;for(var s=t.cssRules.length;s;n["CSSRule"+s]=t.cssRules[s--]);}else{var _=document.createElement("style");document.querySelector("head").appendChild(_),n.sheet=_.sheet}n.rules={}}return t.tag=function(){return e[this.__ident__].sheet.ownerNode},t.add=function(t,n,r){var s=e[this.__ident__],_=s.sheet,i=void 0===r?_.cssRules.length:Math.max(Math.min(Number(r)>>0,_.cssRules.length),0);return _.insertRule(n,i),s.rules[t]=_.cssRules[i]},t.getName=function(t){for(var n=e[this.__ident__],r=Object.keys(n),s=r.length;s--;)if(n[r[s]]===t)return r[s]},t.get=function(t){return e[this.__ident__].rules[t]},t.rename=function(t,n){var r=e[this.__ident__];return r[n]=r[t],delete r[t],r[n]},t.nameFromSelector=function(t){for(var n=e[this.__ident__],r=Object.keys(n),s=r.length;s--;)if(n[r[s]].selectorText===t)return r[s]},t.findFromSelector=function(t){for(var n=e[this.__ident__],r=Object.keys(n),s=r.length;s--;)if(n[r[s]].selectorText===t)return n[r[s]]},t.remove=function(t){var n=e[this.__ident__],r=n.sheet,s=n.rules,_=[].indexOf.call(r.cssRules,s[t]),i=null;return-1!==_&&(r.removeRule(_),i=s[t],delete s[t]),i},t.replace=function(t,n){var r=e[this.__ident__],s=r.sheet,_=r.rules,i=[].indexOf.call(s.cssRules,_[t]);return-1!==i?(s.removeRule(i),s.insertRule(n,i),_[t]=s.cssRules[i],_[t]):this.add(t,n)},n.fromStyleTag=function(e){return e&&e.sheet&&e.sheet.constructor===CSSStyleSheet?new r(e.sheet):null},r}();function sanitizeHref(t){return t&&t.trim().toLowerCase().startsWith("javascript:")?"":t}function binarySearch(t,e,r){for(var n=0,i=e.length-1;n<=i;){var s=n+i>>1,o=r(t,e[s]);if(o>0)n=s+1;else{if(!(o<0))return s;i=s-1}}return-(n+1)}function insertionIndexForObjectInListSortedByFunction(t,e,r){var n=binarySearch(t,e,r);if(n<0)return-n-1;for(;n>0&&0===r(t,e[n-1]);)n--;return n}function createSearchRegex(t,e,r){var n,i=e?"g":"gi";if(r)try{n=new RegExp(t,i)}catch(t){}return n||(n=createPlainTextSearchRegex(t,i)),n}function createPlainTextSearchRegex(t,e){for(var r=String.regexSpecialCharacters(),n="",i=0;i<t.length;++i){var s=t.charAt(i);-1!=r.indexOf(s)&&(n+="\\"),n+=s}return new RegExp(n,e||"")}function countRegexMatches(t,e){for(var r,n=e,i=0;n&&(r=t.exec(n));)r[0].length>0&&++i,n=n.substring(r.index+1);return i}function numberToStringWithSpacesPadding(t,e){var r=t.toString(),n=Math.max(0,e-r.length);return Array(n+1).join(" ")+r}Object.isEmpty=function(t){for(var e in t)return!1;return!0},Object.values=function(t){for(var e=Object.keys(t),r=[],n=0;n<e.length;++n)r.push(t[e[n]]);return r},String.prototype.hasSubstring=function(t,e){return e?this.match(new RegExp(t.escapeForRegExp(),"i")):-1!==this.indexOf(t)},String.prototype.findAll=function(t){for(var e=[],r=this.indexOf(t);-1!==r;)e.push(r),r=this.indexOf(t,r+t.length);return e},String.prototype.lineEndings=function(){return this._lineEndings||(this._lineEndings=this.findAll("\n"),this._lineEndings.push(this.length)),this._lineEndings},String.prototype.escapeCharacters=function(t){for(var e=!1,r=0;r<t.length;++r)if(-1!==this.indexOf(t.charAt(r))){e=!0;break}if(!e)return String(this);var n="";for(r=0;r<this.length;++r)-1!==t.indexOf(this.charAt(r))&&(n+="\\"),n+=this.charAt(r);return n},String.regexSpecialCharacters=function(){return"^[]{}()\\.$*+?|-,"},String.prototype.escapeForRegExp=function(){return this.escapeCharacters(String.regexSpecialCharacters)},String.prototype.escapeHTML=function(){return this.replace(/&/g,"&amp;").replace(/</g,"&lt;").replace(/>/g,"&gt;").replace(/"/g,"&quot;")},String.prototype.collapseWhitespace=function(){return this.replace(/[\s\xA0]+/g," ")},String.prototype.trimMiddle=function(t){if(this.length<=t)return String(this);var e=t>>1,r=t-e-1;return this.substr(0,e)+"…"+this.substr(this.length-r,r)},String.prototype.trimEnd=function(t){return this.length<=t?String(this):this.substr(0,t-1)+"…"},String.prototype.trimURL=function(t){var e=this.replace(/^(https|http|file):\/\//i,"");return t&&(e=e.replace(new RegExp("^"+t.escapeForRegExp(),"i"),"")),e},String.prototype.toTitleCase=function(){return this.substring(0,1).toUpperCase()+this.substring(1)},String.prototype.compareTo=function(t){return this>t?1:this<t?-1:0},String.prototype.removeURLFragment=function(){var t=this.indexOf("#");return-1==t&&(t=this.length),this.substring(0,t)},String.prototype.startsWith=function(t){return!this.lastIndexOf(t,0)},String.prototype.endsWith=function(t){return-1!==this.indexOf(t,this.length-t.length)},Number.constrain=function(t,e,r){return t<e?t=e:t>r&&(t=r),t},Date.prototype.toISO8601Compact=function(){function t(t){return t>9?""+t:"0"+t}return this.getFullYear()+t(this.getMonth()+1)+t(this.getDate())+"T"+t(this.getHours())+t(this.getMinutes())+t(this.getSeconds())},Object.defineProperty(Array.prototype,"remove",{value:function(t,e){if(e){var r=this.indexOf(t);-1!==r&&this.splice(r,1)}else for(var n=this.length,i=0;i<n;++i)this[i]===t&&this.splice(i,1)}}),Object.defineProperty(Array.prototype,"keySet",{value:function(){for(var t={},e=0;e<this.length;++e)t[this[e]]=!0;return t}}),Object.defineProperty(Array.prototype,"upperBound",{value:function(t){for(var e=0,r=this.length;r>0;){var n=r>>1,i=e+n;t>=this[i]?(e=i+1,r-=n+1):r=n}return e}}),Object.defineProperty(Array.prototype,"rotate",{value:function(t){for(var e=[],r=t;r<t+this.length;++r)e.push(this[r%this.length]);return e}}),Object.defineProperty(Uint32Array.prototype,"sort",{value:Array.prototype.sort}),function(){var t={value:function(t,e,r,n){function i(t,e,r){var n=t[e];t[e]=t[r],t[r]=n}var s=this[n];i(this,r,n);for(var o=e,a=e;a<r;++a)t(this[a],s)<0&&(i(this,o,a),++o);return i(this,r,o),o}};Object.defineProperty(Array.prototype,"partition",t),Object.defineProperty(Uint32Array.prototype,"partition",t);var e={value:function(t,e,r,n){return 0===e&&r===this.length-1&&n>=this.length?this.sort(t):function t(e,r,n,i,s){if(!(i<=n)){var o=Math.floor(Math.random()*(i-n))+n,a=e.partition(r,n,i,o);t(e,r,n,a-1,s),a<n+s-1&&t(e,r,a+1,i,n+s-1-a)}}(this,t,e,r,n),this}};Object.defineProperty(Array.prototype,"sortRange",e),Object.defineProperty(Uint32Array.prototype,"sortRange",e)}(),Object.defineProperty(Array.prototype,"qselect",{value:function(t,e){if(!(t<0||t>=this.length)){e||(e=function(t,e){return t-e});for(var r=0,n=this.length-1;;){var i=this.partition(e,r,n,Math.floor((n+r)/2));if(i===t)return this[t];i>t?n=i-1:r=i+1}}}}),Object.defineProperty(Array.prototype,"binaryIndexOf",{value:function(t,e){var r=binarySearch(t,this,e);return r>=0?r:-1}}),Object.defineProperty(Array.prototype,"select",{value:function(t){for(var e=new Array(this.length),r=0;r<this.length;++r)e[r]=this[r][t];return e}}),Object.defineProperty(Array.prototype,"peekLast",{value:function(){return this[this.length-1]}}),Object.defineProperty(Array.prototype,"multidimSort",{value:function(t,e){for(e||(e=[]);e.length<t.length;)e.push("asc");var r=[];for(a=this.length;a--;)if(i=this[a],r.length){for(var n=0,s=r.length-1;n<=s;){for(var o=n+s>>1,u=0,c=r[o],p=-1,h=t.length;0===u&&++p<h;){var f=t[p];switch(e[p]){case"desc":i[f]>c[f]?u=-1:i[f]<c[f]&&(u=1);break;case"asc":default:i[f]<c[f]?u=-1:i[f]>c[f]&&(u=1)}}if(u>0)n=++o;else{if(!(u<0))break;s=o-1}}r.splice(o,0,i)}else r.push(i);return r}}),String.sprintf=function(t,e){return String.vsprintf(t,Array.prototype.slice.call(arguments,1))},String.tokenizeFormatString=function(t,e){var r=[],n=0;function i(t){r.push({type:"string",value:t})}function s(t,e,n){r.push({type:"specifier",specifier:t,precision:e,substitutionIndex:n})}function o(t){return!!/[0-9]/.exec(t)}for(var a=0,u=t.indexOf("%",a);-1!==u;u=t.indexOf("%",a)){if(i(t.substring(a,u)),o(t[a=u+1])){for(var c=parseInt(t.substring(a),10);o(t[a]);)++a;c>0&&"$"===t[a]&&(n=c-1,++a)}var p=-1;if("."===t[a])for(++a,p=parseInt(t.substring(a),10),isNaN(p)&&(p=0);o(t[a]);)++a;t[a]in e?(s(t[a],p,n),++n,++a):(i(t.substring(u,a+1)),++a)}return i(t.substring(a)),r},String.standardFormatters={d:function(t){return isNaN(t)?0:t},f:function(t,e){return t&&e.precision>-1&&(t=t.toFixed(e.precision)),isNaN(t)?e.precision>-1?Number(0).toFixed(e.precision):0:t},s:function(t){return t}},String.vsprintf=function(t,e){return String.format(t,e,String.standardFormatters,"",function(t,e){return t+e}).formattedResult},String.format=function(t,e,r,n,i){if(!t||!e||!e.length)return{formattedResult:i(n,t),unusedSubstitutions:e};function s(){return'String.format("'+t+'", "'+e.join('", "')+'")'}function o(t){console.error(s()+": "+t)}for(var a,u=n,c=String.tokenizeFormatString(t,r),p={},h=0;h<c.length;++h){var f=c[h];"string"!==f.type?"specifier"===f.type?f.substitutionIndex>=e.length?(o("not enough substitution arguments. Had "+e.length+" but needed "+(f.substitutionIndex+1)+", so substitution was skipped."),u=i(u,"%"+(f.precision>-1?f.precision:"")+f.specifier)):(p[f.substitutionIndex]=!0,f.specifier in r?u=i(u,r[f.specifier](e[f.substitutionIndex],f)):(a="unsupported format character “"+f.specifier+"”. Treating as a string.",console.warn(s()+": "+a),u=i(u,e[f.substitutionIndex]))):o('Unknown token type "'+f.type+'" found.'):u=i(u,f.value)}var l=[];for(h=0;h<e.length;++h)h in p||l.push(e[h]);return{formattedResult:u,unusedSubstitutions:l}};var createObjectIdentifier=function(){return"_"+ ++createObjectIdentifier._last};createObjectIdentifier._last=0;var Set=function(){this._set={},this._size=0};Set.prototype={add:function(t){var e=t.__identifier;e||(e=createObjectIdentifier(),t.__identifier=e),this._set[e]||++this._size,this._set[e]=t},remove:function(t){this._set[t.__identifier]&&(--this._size,delete this._set[t.__identifier])},items:function(){var t=new Array(this._size),e=0;for(var r in this._set)t[e++]=this._set[r];return t},hasItem:function(t){return this._set[t.__identifier]},size:function(){return this._size},clear:function(){this._set={},this._size=0}};var Map=function(){this._map={},this._size=0};function loadXHR(t,e,r){var n=new XMLHttpRequest;return n.open("GET",t,e),e&&(n.onreadystatechange=function(){n.readyState===XMLHttpRequest.DONE&&(200!==n.status?r(null):r(n.responseText))}),n.send(null),e?null:200===n.status?n.responseText:null}function StringPool(){this.reset()}Map.prototype={put:function(t,e){var r=t.__identifier;r||(r=createObjectIdentifier(),t.__identifier=r),this._map[r]||++this._size,this._map[r]=[t,e]},remove:function(t){var e=this._map[t.__identifier];if(e)return--this._size,delete this._map[t.__identifier],e[1]},keys:function(){return this._list(0)},values:function(){return this._list(1)},_list:function(t){var e=new Array(this._size),r=0;for(var n in this._map)e[r++]=this._map[n][t];return e},get:function(t){var e=this._map[t.__identifier];return e?e[1]:void 0},contains:function(t){return!!this._map[t.__identifier]},size:function(){return this._size},clear:function(){this._map={},this._size=0}},StringPool.prototype={intern:function(t){if("__proto__"===t)return"__proto__";var e=this._strings[t];return void 0===e&&(this._strings[t]=t,e=t),e},reset:function(){this._strings=Object.create(null)},internObjectStrings:function(t,e){if("number"!=typeof e)e=100;else if(--e<0)throw"recursion depth limit reached in StringPool.deepIntern(), perhaps attempting to traverse cyclical references?";for(var r in t)switch(typeof t[r]){case"string":t[r]=this.intern(t[r]);break;case"object":this.internObjectStrings(t[r],e)}}};var _importedScripts={};function importScript(t){if(!_importedScripts[t]){var e=new XMLHttpRequest;if(_importedScripts[t]=!0,window.flattenImports&&(t=t.split("/").reverse()[0]),e.open("GET",t,!1),e.send(null),!e.responseText)throw"empty response arrived for script '"+t+"'";var r=WebInspector.ParsedURL.completeURL(window.location.href,t);window.eval(e.responseText+"\n//@ sourceURL="+r)}}var loadScript=importScript;String.prototype.parseUrl=function(t){return new URL(this,t||document.baseURI)};var defaultFavicon=null;function getFavicon(t){if(defaultFavicon||$.ajax({url:"chrome://favicon/http://sample.com",async:!1,success:function(t){defaultFavicon=t}}),/^http/.test(t)||(t="http://"+t),/.ico$/.test(t))return t;var e="",r=t.parseUrl(),n=r.hostname.split(".");return 4!==n.length&&3!==n.length||(r.hostname=n.slice(1).join(".")),$.ajax({url:"http://"+r.hostname+"/favicon.ico",async:!1,success:function(t){e="http://"+r.hostname+"/favicon.ico"},error:function(t){e="http://"+r.hostname+"/favicon.ico"}}),e}function copyToClipboard(t){var e=document.createElement("textarea");e.value=t,e.style="width:1px;height:1px;",document.body.appendChild(e),e.select(),document.execCommand("Copy"),document.body.removeChild(e)}function removeSubsequentNodes(e,t){for(var o=e;o&&o!==t;){var n=o;o=o.nextSibling,n.removeSelf()}}function Size(e,t){this.width=e,this.height=t}function AnchorBox(e,t,o,n){this.x=e||0,this.y=t||0,this.width=o||0,this.height=n||0}function isEnterKey(e){return 229!==e.keyCode&&"Enter"===e.keyIdentifier}function consumeEvent(e){e.consume()}function NonLeakingMutationObserver(e){this._observer=new WebKitMutationObserver(e),NonLeakingMutationObserver._instances.push(this),NonLeakingMutationObserver._unloadListener||(NonLeakingMutationObserver._unloadListener=function(){for(;NonLeakingMutationObserver._instances.length;)NonLeakingMutationObserver._instances[NonLeakingMutationObserver._instances.length-1].disconnect()},window.addEventListener("unload",NonLeakingMutationObserver._unloadListener,!1))}Node.prototype.rangeOfWord=function(e,t,o,n){var r,i,s=0,a=0;if(o||(o=this),n&&"backward"!==n&&"both"!==n)r=this,s=e;else{for(var l=this;l;){if(l===o){r||(r=o);break}if(l.nodeType===Node.TEXT_NODE)for(var h=l===this?e-1:l.nodeValue.length-1;h>=0;--h)if(-1!==t.indexOf(l.nodeValue[h])){r=l,s=h+1;break}if(r)break;l=l.traversePreviousNode(o)}r||(r=o,s=0)}if(n&&"forward"!==n&&"both"!==n)i=this,a=e;else{for(l=this;l;){if(l===o){i||(i=o);break}if(l.nodeType===Node.TEXT_NODE)for(h=l===this?e:0;h<l.nodeValue.length;++h)if(-1!==t.indexOf(l.nodeValue[h])){i=l,a=h;break}if(i)break;l=l.traverseNextNode(o)}i||(i=o,a=o.nodeType===Node.TEXT_NODE?o.nodeValue.length:o.childNodes.length)}var f=this.ownerDocument.createRange();return f.setStart(r,s),f.setEnd(i,a),f},Node.prototype.traverseNextTextNode=function(e){var t=this.traverseNextNode(e);if(t){for(;t&&t.nodeType!==Node.TEXT_NODE;)t=t.traverseNextNode(e);return t}},Node.prototype.rangeBoundaryForOffset=function(e){for(var t=this.traverseNextTextNode(this);t&&e>t.nodeValue.length;)e-=t.nodeValue.length,t=t.traverseNextTextNode(this);return t?{container:t,offset:e}:{container:this,offset:0}},Element.prototype.removeStyleClass=function(e){this.classList.remove(e)},Element.prototype.removeMatchingStyleClasses=function(e){var t=new RegExp("(^|\\s+)"+e+"($|\\s+)");t.test(this.className)&&(this.className=this.className.replace(t," "))},Element.prototype.addStyleClass=function(e){this.classList.add(e)},Element.prototype.hasStyleClass=function(e){return this.classList.contains(e)},Element.prototype.enableStyleClass=function(e,t){t?this.addStyleClass(e):this.removeStyleClass(e)},Element.prototype.positionAt=function(e,t){"number"==typeof e?this.style.setProperty("left",e+"px"):this.style.removeProperty("left"),"number"==typeof t?this.style.setProperty("top",t+"px"):this.style.removeProperty("top")},Element.prototype.isScrolledToBottom=function(){return this.scrollTop+this.clientHeight===this.scrollHeight},Element.prototype.removeSelf=function(){this.parentElement&&this.parentElement.removeChild(this)},CharacterData.prototype.removeSelf=Element.prototype.removeSelf,DocumentType.prototype.removeSelf=Element.prototype.removeSelf,Element.prototype.measurePreferredSize=function(e){(e=e||document.body).appendChild(this),this.positionAt(0,0);var t=new Size(this.offsetWidth,this.offsetHeight);return this.positionAt(void 0,void 0),this.removeSelf(),t},Node.prototype.enclosingNodeOrSelfWithNodeNameInArray=function(e){for(var t=this;t&&t!==this.ownerDocument;t=t.parentNode)for(var o=0;o<e.length;++o)if(t.nodeName.toLowerCase()===e[o].toLowerCase())return t;return null},Node.prototype.enclosingNodeOrSelfWithNodeName=function(e){return this.enclosingNodeOrSelfWithNodeNameInArray([e])},Node.prototype.enclosingNodeOrSelfWithClass=function(e,t){for(var o=this;o&&o!==t&&o!==this.ownerDocument;o=o.parentNode)if(o.nodeType===Node.ELEMENT_NODE&&o.hasStyleClass(e))return o;return null},Element.prototype.query=function(e){return this.ownerDocument.evaluate(e,this,null,XPathResult.FIRST_ORDERED_NODE_TYPE,null).singleNodeValue},Element.prototype.removeChildren=function(){this.firstChild&&(this.textContent="")},Element.prototype.isInsertionCaretInside=function(){var e=window.getSelection();return!(!e.rangeCount||!e.isCollapsed)&&e.getRangeAt(0).startContainer.isSelfOrDescendant(this)},Element.prototype.createChild=function(e,t){var o=this.ownerDocument.createElement(e);return t&&(o.className=t),this.appendChild(o),o},DocumentFragment.prototype.createChild=Element.prototype.createChild,Element.prototype.createTextChild=function(e){var t=this.ownerDocument.createTextNode(e);return this.appendChild(t),t},DocumentFragment.prototype.createTextChild=Element.prototype.createTextChild,Element.prototype.totalOffsetLeft=function(){return this.totalOffset().left},Element.prototype.totalOffsetTop=function(){return this.totalOffset().top},Element.prototype.totalOffset=function(){for(var e=0,t=0,o=this;o;o=o.offsetParent)e+=o.offsetLeft,t+=o.offsetTop;return{left:e,top:t}},Element.prototype.scrollOffset=function(){for(var e=0,t=0,o=this;o;o=o.scrollParent)e+=o.scrollLeft,t+=o.scrollTop;return{left:e,top:t}},Element.prototype.offsetRelativeToWindow=function(e){for(var t=new AnchorBox,o=this,n=this.ownerDocument.defaultView;n&&o&&(t.x+=o.totalOffsetLeft(),t.y+=o.totalOffsetTop(),n!==e);)o=n.frameElement,n=n.parent;return t},Element.prototype.boxInWindow=function(e){e=e||this.ownerDocument.defaultView;var t=this.offsetRelativeToWindow(window);return t.width=Math.min(this.offsetWidth,window.innerWidth-t.x),t.height=Math.min(this.offsetHeight,window.innerHeight-t.y),t},Element.prototype.setTextAndTitle=function(e){this.textContent=e,this.title=e},KeyboardEvent.prototype.__defineGetter__("data",function(){switch(this.type){case"keypress":return this.ctrlKey||this.metaKey?"":String.fromCharCode(this.charCode);case"keydown":case"keyup":return this.ctrlKey||this.metaKey||this.altKey?"":String.fromCharCode(this.which)}}),Event.prototype.consume=function(e){this.stopImmediatePropagation(),e&&this.preventDefault(),this.handled=!0},Text.prototype.select=function(e,t){e=e||0,t=t||this.textContent.length,e<0&&(e=t+e);var o=this.ownerDocument.defaultView.getSelection();o.removeAllRanges();var n=this.ownerDocument.createRange();return n.setStart(this,e),n.setEnd(this,t),o.addRange(n),this},Element.prototype.selectionLeftOffset=function(){var e=window.getSelection();if(!e.containsNode(this,!0))return null;for(var t=e.anchorOffset,o=e.anchorNode;o!==this;){for(;o.previousSibling;)t+=(o=o.previousSibling).textContent.length;o=o.parentNode}return t},Node.prototype.isAncestor=function(e){if(!e)return!1;for(var t=e.parentNode;t;){if(this===t)return!0;t=t.parentNode}return!1},Node.prototype.isDescendant=function(e){return!!e&&e.isAncestor(this)},Node.prototype.isSelfOrAncestor=function(e){return!!e&&(e===this||this.isAncestor(e))},Node.prototype.isSelfOrDescendant=function(e){return!!e&&(e===this||this.isDescendant(e))},Node.prototype.traverseNextNode=function(e){var t=this.firstChild;if(t)return t;if(e&&this===e)return null;if(t=this.nextSibling)return t;for(t=this;t&&!t.nextSibling&&(!e||!t.parentNode||t.parentNode!==e);)t=t.parentNode;return t?t.nextSibling:null},Node.prototype.traversePreviousNode=function(e){if(e&&this===e)return null;for(var t=this.previousSibling;t&&t.lastChild;)t=t.lastChild;return t||this.parentNode},NonLeakingMutationObserver._instances=[],NonLeakingMutationObserver.prototype={observe:function(e,t){this._observer&&this._observer.observe(e,t)},disconnect:function(){this._observer&&this._observer.disconnect(),NonLeakingMutationObserver._instances.remove(this),delete this._observer}};function TreeOutline(e,t){this.children=[],this.selectedTreeElement=null,this._childrenListNode=e,this.childrenListElement=this._childrenListNode,this._childrenListNode.removeChildren(),this.expandTreeElementsWhenArrowing=!1,this.root=!0,this.hasChildren=!1,this.expanded=!0,this.selected=!1,this.treeOutline=this,this.comparator=null,this.searchable=!1,this.searchInputElement=null,this.setFocusable(!t),this._childrenListNode.addEventListener("keydown",this._treeKeyDown.bind(this),!0),this._childrenListNode.addEventListener("keypress",this._treeKeyPress.bind(this),!0),this._treeElementsMap=new Map,this._expandedStateMap=new Map}function TreeElement(e,t,i){this._title=e,this.representedObject=t||{},this._hidden=!1,this._selectable=!0,this.expanded=!1,this.selected=!1,this.hasChildren=i,this.children=[],this.treeOutline=null,this.parent=null,this.previousSibling=null,this.nextSibling=null,this._listItemNode=null}TreeOutline.prototype.setFocusable=function(e){e?this._childrenListNode.setAttribute("tabIndex",0):this._childrenListNode.removeAttribute("tabIndex")},TreeOutline.prototype.appendChild=function(e){var t;t=this.treeOutline.comparator?insertionIndexForObjectInListSortedByFunction(e,this.children,this.treeOutline.comparator):this.children.length,this.insertChild(e,t)},TreeOutline.prototype.insertChild=function(e,t){if(!e)throw"child can't be undefined or null";var i=t>0?this.children[t-1]:null;i?(i.nextSibling=e,e.previousSibling=i):e.previousSibling=null;var n=this.children[t];n?(n.previousSibling=e,e.nextSibling=n):e.nextSibling=null,this.children.splice(t,0,e),this.hasChildren=!0,e.parent=this,e.treeOutline=this.treeOutline,e.treeOutline._rememberTreeElement(e);for(var r=e.children[0];r;)r.treeOutline=this.treeOutline,r.treeOutline._rememberTreeElement(r),r=r.traverseNextTreeElement(!1,e,!0);e.hasChildren&&void 0!==e.treeOutline._expandedStateMap.get(e.representedObject)&&(e.expanded=e.treeOutline._expandedStateMap.get(e.representedObject)),this._childrenListNode||(this._childrenListNode=this.treeOutline._childrenListNode.ownerDocument.createElement("ol"),this._childrenListNode.parentTreeElement=this,this._childrenListNode.classList.add("children"),this.hidden&&this._childrenListNode.classList.add("hidden")),e._attach()},TreeOutline.prototype.removeChildAtIndex=function(e){if(e<0||e>=this.children.length)throw"childIndex out of range";var t=this.children[e];this.children.splice(e,1);var i=t.parent;t.deselect()&&(t.previousSibling?t.previousSibling.select():t.nextSibling?t.nextSibling.select():i.select()),t.previousSibling&&(t.previousSibling.nextSibling=t.nextSibling),t.nextSibling&&(t.nextSibling.previousSibling=t.previousSibling),t.treeOutline&&(t.treeOutline._forgetTreeElement(t),t.treeOutline._forgetChildrenRecursive(t)),t._detach(),t.treeOutline=null,t.parent=null,t.nextSibling=null,t.previousSibling=null},TreeOutline.prototype.removeChild=function(e){if(!e)throw"child can't be undefined or null";var t=this.children.indexOf(e);if(-1===t)throw"child not found in this node's children";this.removeChildAtIndex.call(this,t)},TreeOutline.prototype.removeChildren=function(){for(var e=0;e<this.children.length;++e){var t=this.children[e];t.deselect(),t.treeOutline&&(t.treeOutline._forgetTreeElement(t),t.treeOutline._forgetChildrenRecursive(t)),t._detach(),t.treeOutline=null,t.parent=null,t.nextSibling=null,t.previousSibling=null}this.children=[]},TreeOutline.prototype._rememberTreeElement=function(e){this._treeElementsMap.get(e.representedObject)||this._treeElementsMap.put(e.representedObject,[]);var t=this._treeElementsMap.get(e.representedObject);-1===t.indexOf(e)&&t.push(e)},TreeOutline.prototype._forgetTreeElement=function(e){if(this._treeElementsMap.get(e.representedObject)){var t=this._treeElementsMap.get(e.representedObject);t.remove(e,!0),t.length||this._treeElementsMap.remove(e.representedObject)}},TreeOutline.prototype._forgetChildrenRecursive=function(e){for(var t=e.children[0];t;)this._forgetTreeElement(t),t=t.traverseNextTreeElement(!1,e,!0)},TreeOutline.prototype.getCachedTreeElement=function(e){if(!e)return null;var t=this._treeElementsMap.get(e);return t&&t.length?t[0]:null},TreeOutline.prototype.findTreeElement=function(e,t,i){if(!e)return null;var n=this.getCachedTreeElement(e);if(n)return n;for(var r=[],s=i(e);s&&(r.push(s),!this.getCachedTreeElement(s));s=i(s));if(!s)return null;for(var l=r.length-1;l>=0;--l){var h=this.getCachedTreeElement(r[l]);h&&h.onpopulate()}return this.getCachedTreeElement(e)},TreeOutline.prototype.treeElementFromPoint=function(e,t){var i=this._childrenListNode.ownerDocument.elementFromPoint(e,t);if(!i)return null;var n=i.enclosingNodeOrSelfWithNodeNameInArray(["ol","li"]);return n?n.parentTreeElement||n.treeElement:null},TreeOutline.prototype._treeKeyPress=function(e){if(this.searchable&&!WebInspector.isBeingEdited(this._childrenListNode)){var t=String.fromCharCode(e.charCode);t.trim()===t&&(this._startSearch(t),e.consume(!0))}},TreeOutline.prototype._treeKeyDown=function(e){if(e.target===this._childrenListNode&&this.selectedTreeElement&&!e.shiftKey&&!e.metaKey&&!e.ctrlKey){var t,i=!1;if("Up"!==e.keyIdentifier||e.altKey)if("Down"!==e.keyIdentifier||e.altKey)if("Left"===e.keyIdentifier){if(this.selectedTreeElement.expanded)e.altKey?this.selectedTreeElement.collapseRecursively():this.selectedTreeElement.collapse(),i=!0;else if(this.selectedTreeElement.parent&&!this.selectedTreeElement.parent.root)if(i=!0,this.selectedTreeElement.parent.selectable){for(t=this.selectedTreeElement.parent;t&&!t.selectable;)t=t.parent;i=!!t}else this.selectedTreeElement.parent&&this.selectedTreeElement.parent.collapse()}else if("Right"===e.keyIdentifier)if(this.selectedTreeElement.revealed()){if(this.selectedTreeElement.hasChildren)if(i=!0,this.selectedTreeElement.expanded){for(t=this.selectedTreeElement.children[0];t&&!t.selectable;)t=t.nextSibling;i=!!t}else e.altKey?this.selectedTreeElement.expandRecursively():this.selectedTreeElement.expand()}else this.selectedTreeElement.reveal(),i=!0;else 8===e.keyCode||46===e.keyCode?i=this.selectedTreeElement.ondelete():isEnterKey(e)?i=this.selectedTreeElement.onenter():e.keyCode===WebInspector.KeyboardShortcut.Keys.Space.code&&(i=this.selectedTreeElement.onspace());else{for(t=this.selectedTreeElement.traverseNextTreeElement(!0);t&&!t.selectable;)t=t.traverseNextTreeElement(!this.expandTreeElementsWhenArrowing);i=!!t}else{for(t=this.selectedTreeElement.traversePreviousTreeElement(!0);t&&!t.selectable;)t=t.traversePreviousTreeElement(!this.expandTreeElementsWhenArrowing);i=!!t}t&&(t.reveal(),t.select(!1,!0)),i&&e.consume(!0)}},TreeOutline.prototype.expand=function(){},TreeOutline.prototype.collapse=function(){},TreeOutline.prototype.revealed=function(){return!0},TreeOutline.prototype.reveal=function(){},TreeOutline.prototype.select=function(){},TreeOutline.prototype.revealAndSelect=function(e){},TreeOutline.prototype._startSearch=function(e){this.searchInputElement&&this.searchable&&(this._searching=!0,this.searchStarted&&this.searchStarted(),this.searchInputElement.value=e,window.setTimeout(function(){this.searchInputElement.focus()}.bind(this),0),this._searchTextChanged(),this._boundSearchTextChanged=this._searchTextChanged.bind(this),this.searchInputElement.addEventListener("paste",this._boundSearchTextChanged),this.searchInputElement.addEventListener("cut",this._boundSearchTextChanged),this.searchInputElement.addEventListener("keypress",this._boundSearchTextChanged),this._boundSearchInputKeyDown=this._searchInputKeyDown.bind(this),this.searchInputElement.addEventListener("keydown",this._boundSearchInputKeyDown),this._boundSearchInputBlur=this._searchInputBlur.bind(this),this.searchInputElement.addEventListener("blur",this._boundSearchInputBlur))},TreeOutline.prototype._searchTextChanged=function(){window.setTimeout(function(){var e=this._nextSearchMatch(this.searchInputElement.value,this.selectedTreeElement,!1);e||(e=this._nextSearchMatch(this.searchInputElement.value,this.children[0],!1)),this._showSearchMatchElement(e)}.bind(this),0)},TreeOutline.prototype._showSearchMatchElement=function(e){this._currentSearchMatchElement=e,e?(this._childrenListNode.classList.add("search-match-found"),this._childrenListNode.classList.remove("search-match-not-found"),e.revealAndSelect(!0)):(this._childrenListNode.classList.remove("search-match-found"),this._childrenListNode.classList.add("search-match-not-found"))},TreeOutline.prototype._searchInputKeyDown=function(e){if(!(e.shiftKey||e.metaKey||e.ctrlKey||e.altKey)){var t,i=!1;if("Down"===e.keyIdentifier)t=this._nextSearchMatch(this.searchInputElement.value,this.selectedTreeElement,!0),i=!0;else if("Up"===e.keyIdentifier)t=this._previousSearchMatch(this.searchInputElement.value,this.selectedTreeElement),i=!0;else if(27===e.keyCode)this._searchFinished(),i=!0;else if(isEnterKey(e)){var n=this._currentSearchMatchElement;this._searchFinished(),n.onenter(),i=!0}t&&this._showSearchMatchElement(t),i?e.consume(!0):window.setTimeout(this._boundSearchTextChanged,0)}},TreeOutline.prototype._nextSearchMatch=function(e,t,i){for(var n=t,r=i;n&&(r||!n.matchesSearchText||!n.matchesSearchText(e));)n=n.traverseNextTreeElement(!0,null,!0),r=!1;return n},TreeOutline.prototype._previousSearchMatch=function(e,t){for(var i=t,n=!0;i&&(n||!i.matchesSearchText||!i.matchesSearchText(e));)i=i.traversePreviousTreeElement(!0,!0),n=!1;return i},TreeOutline.prototype._searchInputBlur=function(e){this._searchFinished()},TreeOutline.prototype._searchFinished=function(){this._searching&&(delete this._searching,this._childrenListNode.classList.remove("search-match-found"),this._childrenListNode.classList.remove("search-match-not-found"),delete this._currentSearchMatchElement,this.searchInputElement.value="",this.searchInputElement.removeEventListener("paste",this._boundSearchTextChanged),this.searchInputElement.removeEventListener("cut",this._boundSearchTextChanged),delete this._boundSearchTextChanged,this.searchInputElement.removeEventListener("keydown",this._boundSearchInputKeyDown),delete this._boundSearchInputKeyDown,this.searchInputElement.removeEventListener("blur",this._boundSearchInputBlur),delete this._boundSearchInputBlur,this.searchFinished&&this.searchFinished(),this.treeOutline._childrenListNode.focus())},TreeOutline.prototype.stopSearch=function(){this._searchFinished()},TreeElement.prototype={arrowToggleWidth:10,get selectable(){return!this._hidden&&this._selectable},set selectable(e){this._selectable=e},get listItemElement(){return this._listItemNode},get childrenListElement(){return this._childrenListNode},get title(){return this._title},set title(e){this._title=e,this._setListItemNodeContent()},get tooltip(){return this._tooltip},set tooltip(e){this._tooltip=e,this._listItemNode&&(this._listItemNode.title=e||"")},get hasChildren(){return this._hasChildren},set hasChildren(e){this._hasChildren!==e&&(this._hasChildren=e,this._listItemNode&&(e?this._listItemNode.classList.add("parent"):(this._listItemNode.classList.remove("parent"),this.collapse())))},get hidden(){return this._hidden},set hidden(e){this._hidden!==e&&(this._hidden=e,e?(this._listItemNode&&this._listItemNode.classList.add("hidden"),this._childrenListNode&&this._childrenListNode.classList.add("hidden")):(this._listItemNode&&this._listItemNode.classList.remove("hidden"),this._childrenListNode&&this._childrenListNode.classList.remove("hidden")))},get shouldRefreshChildren(){return this._shouldRefreshChildren},set shouldRefreshChildren(e){this._shouldRefreshChildren=e,e&&this.expanded&&this.expand()},_setListItemNodeContent:function(){this._listItemNode&&("string"==typeof this._title?this._listItemNode.textContent=this._title:(this._listItemNode.removeChildren(),this._title&&this._listItemNode.appendChild(this._title)))}},TreeElement.prototype.appendChild=TreeOutline.prototype.appendChild,TreeElement.prototype.insertChild=TreeOutline.prototype.insertChild,TreeElement.prototype.removeChild=TreeOutline.prototype.removeChild,TreeElement.prototype.removeChildAtIndex=TreeOutline.prototype.removeChildAtIndex,TreeElement.prototype.removeChildren=TreeOutline.prototype.removeChildren,TreeElement.prototype._attach=function(){this._listItemNode&&!this.parent._shouldRefreshChildren||(this._listItemNode&&this._listItemNode.parentNode&&this._listItemNode.parentNode.removeChild(this._listItemNode),this._listItemNode=this.treeOutline._childrenListNode.ownerDocument.createElement("li"),this._listItemNode.treeElement=this,this._setListItemNodeContent(),this._listItemNode.title=this._tooltip?this._tooltip:"",this.hidden&&this._listItemNode.classList.add("hidden"),this.hasChildren&&this._listItemNode.classList.add("parent"),this.expanded&&this._listItemNode.classList.add("expanded"),this.selected&&this._listItemNode.classList.add("selected"),this._listItemNode.addEventListener("mousedown",TreeElement.treeElementMouseDown,!1),this._listItemNode.addEventListener("click",TreeElement.treeElementToggled,!1),this._listItemNode.addEventListener("dblclick",TreeElement.treeElementDoubleClicked,!1),this.onattach());var e=null;this.nextSibling&&this.nextSibling._listItemNode&&this.nextSibling._listItemNode.parentNode===this.parent._childrenListNode&&(e=this.nextSibling._listItemNode),this.parent._childrenListNode.insertBefore(this._listItemNode,e),this._childrenListNode&&this.parent._childrenListNode.insertBefore(this._childrenListNode,this._listItemNode.nextSibling),this.selected&&this.select(),this.expanded&&this.expand()},TreeElement.prototype._detach=function(){this._listItemNode&&this._listItemNode.parentNode&&this._listItemNode.parentNode.removeChild(this._listItemNode),this._childrenListNode&&this._childrenListNode.parentNode&&this._childrenListNode.parentNode.removeChild(this._childrenListNode)},TreeElement.treeElementMouseDown=function(e){var t=e.currentTarget;t&&t.treeElement&&t.treeElement.selectable&&(t.treeElement.isEventWithinDisclosureTriangle(e)||t.treeElement.selectOnMouseDown(e))},TreeElement.treeElementToggled=function(e){var t=e.currentTarget;if(t&&t.treeElement){var i=t.treeElement.toggleOnClick&&!t.treeElement.selectable,n=t.treeElement.isEventWithinDisclosureTriangle(e);(i||n)&&(t.treeElement.expanded?e.altKey?t.treeElement.collapseRecursively():t.treeElement.collapse():e.altKey?t.treeElement.expandRecursively():t.treeElement.expand(),e.consume())}},TreeElement.treeElementDoubleClicked=function(e){var t=e.currentTarget;t&&t.treeElement&&(t.treeElement.ondblclick.call(t.treeElement,e)||t.treeElement.hasChildren&&!t.treeElement.expanded&&t.treeElement.expand())},TreeElement.prototype.collapse=function(){this._listItemNode&&this._listItemNode.classList.remove("expanded"),this._childrenListNode&&this._childrenListNode.classList.remove("expanded"),this.expanded=!1,this.treeOutline&&this.treeOutline._expandedStateMap.put(this.representedObject,!1),this.oncollapse()},TreeElement.prototype.collapseRecursively=function(){for(var e=this;e;)e.expanded&&e.collapse(),e=e.traverseNextTreeElement(!1,this,!0)},TreeElement.prototype.expand=function(){if(this.hasChildren&&(!this.expanded||this._shouldRefreshChildren||!this._childrenListNode)){if(this.expanded=!0,this.treeOutline&&this.treeOutline._expandedStateMap.put(this.representedObject,!0),this.treeOutline&&(!this._childrenListNode||this._shouldRefreshChildren)){this._childrenListNode&&this._childrenListNode.parentNode&&this._childrenListNode.parentNode.removeChild(this._childrenListNode),this._childrenListNode=this.treeOutline._childrenListNode.ownerDocument.createElement("ol"),this._childrenListNode.parentTreeElement=this,this._childrenListNode.classList.add("children"),this.hidden&&this._childrenListNode.classList.add("hidden"),this.onpopulate();for(var e=0;e<this.children.length;++e)this.children[e]._attach();delete this._shouldRefreshChildren}this._listItemNode&&(this._listItemNode.classList.add("expanded"),this._childrenListNode&&this._childrenListNode.parentNode!=this._listItemNode.parentNode&&this.parent._childrenListNode.insertBefore(this._childrenListNode,this._listItemNode.nextSibling)),this._childrenListNode&&this._childrenListNode.classList.add("expanded"),this.onexpand()}},TreeElement.prototype.expandRecursively=function(e){var t=this,i={},n=0;for(isNaN(e)&&(e=3);t;)n<e&&t.expand(),t=t.traverseNextTreeElement(!1,this,n>=e,i),n+=i.depthChange},TreeElement.prototype.hasAncestor=function(e){if(!e)return!1;for(var t=this.parent;t;){if(e===t)return!0;t=t.parent}return!1},TreeElement.prototype.reveal=function(){for(var e=this.parent;e&&!e.root;)e.expanded||e.expand(),e=e.parent;this.onreveal(this)},TreeElement.prototype.revealed=function(){for(var e=this.parent;e&&!e.root;){if(!e.expanded)return!1;e=e.parent}return!0},TreeElement.prototype.selectOnMouseDown=function(e){this.select(!1,!0)&&e.consume(!0)},TreeElement.prototype.select=function(e,t){return!(!this.treeOutline||!this.selectable||this.selected)&&(this.treeOutline.selectedTreeElement&&this.treeOutline.selectedTreeElement.deselect(),this.selected=!0,e||this.treeOutline._childrenListNode.focus(),!!this.treeOutline&&(this.treeOutline.selectedTreeElement=this,this._listItemNode&&this._listItemNode.classList.add("selected"),this.onselect(t)))},TreeElement.prototype.revealAndSelect=function(e){this.reveal(),this.select(e)},TreeElement.prototype.deselect=function(e){return!(!this.treeOutline||this.treeOutline.selectedTreeElement!==this||!this.selected)&&(this.selected=!1,this.treeOutline.selectedTreeElement=null,this._listItemNode&&this._listItemNode.classList.remove("selected"),!0)},TreeElement.prototype.onpopulate=function(){},TreeElement.prototype.onenter=function(){},TreeElement.prototype.ondelete=function(){},TreeElement.prototype.onspace=function(){},TreeElement.prototype.onattach=function(){},TreeElement.prototype.onexpand=function(){},TreeElement.prototype.oncollapse=function(){},TreeElement.prototype.ondblclick=function(){},TreeElement.prototype.onreveal=function(){},TreeElement.prototype.onselect=function(e){},TreeElement.prototype.traverseNextTreeElement=function(e,t,i,n){!i&&this.hasChildren&&this.onpopulate(),n&&(n.depthChange=0);var r=e?this.revealed()?this.children[0]:null:this.children[0];if(r&&(!e||e&&this.expanded))return n&&(n.depthChange=1),r;if(this===t)return null;if(r=e?this.revealed()?this.nextSibling:null:this.nextSibling)return r;for(r=this;r&&!r.root&&!(e?r.revealed()&&r.nextSibling:r.nextSibling)&&r.parent!==t;)n&&(n.depthChange-=1),r=r.parent;return r?e?r.revealed()?r.nextSibling:null:r.nextSibling:null},TreeElement.prototype.traversePreviousTreeElement=function(e,t){var i=e?this.revealed()?this.previousSibling:null:this.previousSibling;for(!t&&i&&i.hasChildren&&i.onpopulate();i&&(e?i.revealed()&&i.expanded&&i.children[i.children.length-1]:i.children[i.children.length-1]);)!t&&i.hasChildren&&i.onpopulate(),i=e?i.revealed()&&i.expanded?i.children[i.children.length-1]:null:i.children[i.children.length-1];return i||(!this.parent||this.parent.root?null:this.parent)},TreeElement.prototype.isEventWithinDisclosureTriangle=function(e){var t=window.getComputedStyle(this._listItemNode).getPropertyCSSValue("padding-left"),i=t?t.getFloatValue(CSSPrimitiveValue.CSS_PX):0,n=this._listItemNode.totalOffsetLeft()+i;return e.pageX>=n&&e.pageX<=n+this.arrowToggleWidth&&this.hasChildren};var WebInspector={platform:function(){if(!WebInspector._platform){var e=navigator.userAgent.match(/Windows NT/);e?WebInspector._platform="windows":(e=navigator.userAgent.match(/Mac OS X/),WebInspector._platform=e?"mac":"linux")}return WebInspector._platform},PlatformFlavor:{WindowsVista:"windows-vista",MacTiger:"mac-tiger",MacLeopard:"mac-leopard",MacSnowLeopard:"mac-snowleopard",MacLion:"mac-lion",MacMountainLion:"mac-mountain-lion"},detectFlavor:function(){var e=navigator.userAgent;if("windows"===WebInspector.platform())return(t=e.match(/Windows NT (\d+)\.(?:\d+)/))&&t[1]>=6?this.PlatformFlavor.WindowsVista:null;if("mac"===WebInspector.platform()){var t;if(!(t=e.match(/Mac OS X\s*(?:(\d+)_(\d+))?/))||10!==t[1])return WebInspector.PlatformFlavor.MacSnowLeopard;switch(Number(t[2])){case 4:return WebInspector.PlatformFlavor.MacTiger;case 5:return WebInspector.PlatformFlavor.MacLeopard;case 6:return WebInspector.PlatformFlavor.MacSnowLeopard;case 7:return WebInspector.PlatformFlavor.MacLion;case 8:return WebInspector.PlatformFlavor.MacMountainLion;default:return""}}},port:function(){return WebInspector._port||(WebInspector._port="unknown"),WebInspector._port},isMac:function(){return void 0===WebInspector._isMac&&(WebInspector._isMac="mac"===WebInspector.platform()),WebInspector._isMac},isWin:function(){return void 0===WebInspector._isWin&&(WebInspector._isWin="windows"===WebInspector.platform()),WebInspector._isWin},installPortStyles:function(){var e=WebInspector.platform();document.body.addStyleClass("platform-"+e);var t=WebInspector.platformFlavor();t&&document.body.addStyleClass("platform-"+t);var n=WebInspector.port();document.body.addStyleClass("port-"+n)},_elementDragStart:function(e,t,n,r,o){if(!(o.button||WebInspector.isMac()&&o.ctrlKey)&&!WebInspector._elementDraggingEventListener&&(!e||e(o))){WebInspector._elementDraggingGlassPane&&(WebInspector._elementDraggingGlassPane.dispose(),delete WebInspector._elementDraggingGlassPane);var s=o.target.ownerDocument;WebInspector._elementDraggingEventListener=t,WebInspector._elementEndDraggingEventListener=n,WebInspector._mouseOutWhileDraggingTargetDocument=s,s.addEventListener("mousemove",WebInspector._elementDragMove,!0),s.addEventListener("mouseup",WebInspector._elementDragEnd,!0),s.addEventListener("mouseout",WebInspector._mouseOutWhileDragging,!0),s.body.style.cursor=r,o.preventDefault()}},_mouseOutWhileDragging:function(){WebInspector._unregisterMouseOutWhileDragging(),WebInspector._elementDraggingGlassPane=new WebInspector.GlassPane},_unregisterMouseOutWhileDragging:function(){WebInspector._mouseOutWhileDraggingTargetDocument&&(WebInspector._mouseOutWhileDraggingTargetDocument.removeEventListener("mouseout",WebInspector._mouseOutWhileDragging,!0),delete WebInspector._mouseOutWhileDraggingTargetDocument)},_elementDragMove:function(e){WebInspector._elementDraggingEventListener(e)&&WebInspector._cancelDragEvents(e)},_cancelDragEvents:function(e){var t=e.target.ownerDocument;t.removeEventListener("mousemove",WebInspector._elementDragMove,!0),t.removeEventListener("mouseup",WebInspector._elementDragEnd,!0),WebInspector._unregisterMouseOutWhileDragging(),t.body.style.removeProperty("cursor"),WebInspector._elementDraggingGlassPane&&WebInspector._elementDraggingGlassPane.dispose(),delete WebInspector._elementDraggingGlassPane,delete WebInspector._elementDraggingEventListener,delete WebInspector._elementEndDraggingEventListener},_elementDragEnd:function(e){var t=WebInspector._elementEndDraggingEventListener;WebInspector._cancelDragEvents(e),e.preventDefault(),t&&t(e)},GlassPane:function(){if(WebInspector._glassPane){var e=WebInspector._glassPane.element;return e.parentElement&&e.parentElement===document.body||document.body.appendChild(e),WebInspector._glassPane}this.element=document.createElement("div"),this.element.style.cssText="position:absolute;top:0;bottom:0;left:0;right:0;background-color:transparent;z-index:1000;",this.element.id="glass-pane-for-drag",document.body.appendChild(this.element),WebInspector._glassPane=this}};WebInspector.GlassPane.prototype={dispose:function(){delete WebInspector._glassPane,this.element.parentElement&&this.element.parentElement.removeChild(this.element)}},WebInspector.View=function(e){this.element=e||document.createElement("div"),this.element.__view=this,this._visible=!0,this._isRoot=!1,this._isShowing=!1,this._children=[],this._hideOnDetach=!0,this._notificationDepth=0},WebInspector.View.prototype={doResize:function(){this.onResize()},show:function(e,t){if(this.element.parentElement!==e)this.element.parentElement&&this.detach();else if(this._visible)return;this._visible=!0,this.element.addStyleClass("visible"),this.element.parentElement!==e&&(t?e.insertBefore(this.element,t):e.appendChild(this.element))},detach:function(e){if(this.element.parentElement)return this._hideOnDetach&&!e?(this.element.removeStyleClass("visible"),void(this._visible=!1)):void(this._visible=!1)}};WaspUI={},WaspUI.BYPASS_TYPE_HIDE="hide",WaspUI.BYPASS_TYPE_BLOCK="block",WaspUI.BYPASS_TYPE_OVERRIDE="override",WaspUI.BYPASS_TAB_TRACKED="0tracked",WaspUI.BYPASS_TAB_ALL="0all",WaspUI.BYPASS_DURATION_NEVER=0,WaspUI.BYPASS_DURATION_WINDOW=1,WaspUI.BYPASS_DURATION_SESSION=2,WaspUI.BYPASS_DURATION_ALWAYS=4,WaspUI.BYPASS_SCOPE_PAGE=1,WaspUI.BYPASS_SCOPE_DOMAIN=2,WaspUI.BYPASS_SCOPE_ALL=4,WaspUI.BYPASS_OVERRIDE_FILE="file",WaspUI.BYPASS_OVERRIDE_URL="url",WaspUI.FATAL_ERROR=!1,WaspUI.cql=new CSSql,WaspUI.chron=new Chron;try{WaspUI.displayType=localStorage.userType||"Implementer",WaspUI.settings=new function(){this.get=function(e,t){if(void 0===e)return t;var n=window.localStorage.getItem("WaspUI."+e);return void 0!==t&&null===n?(this.set(e,t),t):n},this.set=function(e,t){void 0!==e&&window.localStorage.setItem("WaspUI."+e,t)},this.has=function(e){return!(null===window.localStorage.getItem("WaspUI."+e))},this.remove=function(e){window.localStorage.removeItemItem("WaspUI"+e)}},WaspUI.cql.load("bypass"),WaspUI.cql.append("bypass",CSSql.SCOPE_LOCAL,"session"),WaspUI.cql.append("bypass",CSSql.SCOPE_LOCAL,"always")}catch(e){if("SecurityError"!=e.name)throw e;WaspUI.FATAL_ERROR={title:"Error: 3rd party cookies and local storage are disabled and preventing WASP from working.",fix:"http://support.webanalyticssolutionprofiler.com/knowledgebase/articles/321072-wasp-chrome-3rd-party-tags-blocking-known-issue",details:e}}WaspUI.addBypass=function(e,t,n,a,s,o,i,r,c){var l={type:e,url:t.split(/#|\?/)[0],tab:i||WaspUI.BYPASS_TAB_TRACKED,isDomain:n,duration:a,scope:s,scopeUrl:o.split(/#|\?/)[0],override:r||"",overrideUrl:(c||"").split(/#|\?/)[0]};if(WaspUI.cql.insert("bypass",l),a===WaspUI.BYPASS_DURATION_SESSION?WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_SESSION,"session"):a===WaspUI.BYPASS_DURATION_ALWAYS&&WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_ALWAYS,"always"),e!==WaspUI.BYPASS_TYPE_HIDE){var d={"msg-type":"bypass",bypassData:[l],action:"append"};WaspUI.messages.port.postMessage(d)}},WaspUI.clearBypass=function(e,t,n,a,s){var o="type="+e+',url="'+t+'"';n===WaspUI.BYPASS_SCOPE_ALL?o+=",scope="+n:o+=',scopeUrl="'+n+'"',e===WaspUI.BYPASS_TYPE_OVERRIDE&&(o+=',overrideUrl="'+s+'"'),WaspUI.cql.delete("bypass",o)},WaspUI.getBypasses=function(e,t,n,a,s){var o="";return e&&(o="type="+e),t&&(o+=o.length?",":"",o+='url="'+t.split(/#|\?/)[0]+'"'),n&&(o+=o.length?",":"",o+="scope="+n),a&&(o+=o.length?",":"",o+='scopeUrl="'+a.split(/#|\?/)[0]+'"'),s&&(o+=o.length?",":"",o+='overrideUrl="'+s.split(/#|\?/)[0]+'"'),WaspUI.cql.select("bypass",o)},WaspUI.saveBypasses=function(e){e!==WaspUI.BYPASS_DURATION_ALWAYS&&WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_SESSION,"session"),e!==WaspUI.BYPASS_DURATION_SESSION&&WaspUI.cql.save("bypass",CSSql.SCOPE_LOCAL,"duration="+WaspUI.BYPASS_DURATION_ALWAYS,"always");var t={"msg-type":"bypass",bypassData:WaspUI.cql.select("bypass","type=block||type=override"),action:"override"};WaspUI.messages.port.postMessage(t)},WaspUI.connections=(WaspUI.cql.load("connection"),{}),WaspUI.connections.panels=[],WaspUI.connections.findUrl=function(e,t){t||(t=WaspUI.mainPanel.currentContent);var n=t.handle;return WaspUI.cql.select("connection",'from="'+e+'",panel='+n+'||to="'+e+'",panel='+n)},WaspUI.connections.clearPanelConnections=function(e){var t=WaspUI.connections.panels.indexOf(e.handle);return-1!==t&&(WaspUI.scriptinfo.clearPanel(e),WaspUI.cql.delete("connection","panel="+t),WaspUI.connections.panels.splice(t,1),e.onRemove=null),e},WaspUI.connections.add=function(e,t,n){n||(n=WaspUI.mainPanel.currentContent),-1===this.panels.indexOf(n.handle)&&(this.panels.push(n.handle),n.onRemove=WaspUI.connections.clearPanelConnections);var a='from="'+(e=String(e).split("#")[0])+'",to="'+(t=String(t).split("#")[0])+'",panel='+n.handle,s=(WaspUI.cql.select("connection",a)||[!1])[0];return s?(s.count++,WaspUI.cql.update("connection","count="+s.count,a)):(s=new WaspUI.connectionItem(e,t,n),WaspUI.cql.insert("connection",s)),s},WaspUI.connectionItem=function(e,t,n){n||(n=WaspUI.mainPanel.currentContent),this.from=e,this.to=t,this.panel=n.handle,this.count=1,this.connected=!1},WaspUI.findConnections=function(e,t){return WaspUI.connections.findUrl(e,t)},WaspUI.scriptinfo=(WaspUI.cql.load("scriptinfo"),{}),WaspUI.scriptinfo.get=function(e,t){e=e.split("#")[0],t||(t=WaspUI.mainPanel.currentContent);var n='src="'+e+'",panel="'+t.handle+'"';return WaspUI.cql.select("scriptinfo",n)[0]},WaspUI.scriptinfo.set=function(e,t,n,a,s){if(t){s||(s=WaspUI.mainPanel.currentContent);var o='src="'+t+'",panel="'+s.handle+'"';WaspUI.cql.count("scriptinfo",o)?e&&WaspUI.cql.update("scriptinfo",{src:t,panel:s.handle,location:n,async:a},o):WaspUI.cql.insert("scriptinfo",{src:t,panel:s.handle,location:n,async:a})}},WaspUI.scriptinfo.clearPanel=function(e){e||(e=WaspUI.mainPanel.currentContent),WaspUI.cql.delete("scriptinfo","panel="+e.handle)},WaspUI.findNodeFromUrl=function(e,t,n){return t||(t=WaspUI.mainPanel.currentContent),n?t.element.querySelector('li[data-url=^"'+e+'"]'):t.element.querySelector('li[data-url="'+e+'"]')},WaspUI.findNodelistFromUrl=function(e,t,n){return t||(t=WaspUI.mainPanel.currentContent),n?t.element.querySelectorAll('li[data-url^="'+e+'"]'):t.element.querySelectorAll('li[data-url="'+e+'"]')},WaspUI.findDomainNodes=function(e,t){return t||(t=WaspUI.mainPanel.currentContent),t.element.querySelectorAll('li.domain[data-domain="'+e+'"]')},WaspUI.viewController=void 0,WaspUI.sidebarPanel=void 0,WaspUI.mainPanel=void 0,WaspUI.devtoolsExtension=void 0,WaspUI.messages=new MessageDeligate,WaspUI.initiatePanel=function(e){WaspUI.devtoolsExtension=e,e.onSearch.addListener(WaspUI.doSearchAction),WaspUI.currentTab=chrome.devtools.inspectedWindow.tabId;var t=WaspUI.viewController=new WaspUI.SplitView(!0),n=(WaspUI.sidebarPanel=t.sidebarElement).toolbar;n.detailsButton=t.createButtonAndRegisterShortcuts("sidebar-view-details","View Details",WaspUI.displayNodeDetails.bind(n),""),n.detailsButton.toggled=1,n.appendChild(n.detailsButton.element),n.contentButton=t.createButtonAndRegisterShortcuts("sidebar-view-content","View Content",WaspUI.displayNodeContent.bind(n),""),n.contentButton.toggled=0,n.appendChild(n.contentButton.element),n.settingsButton=t.createButtonAndRegisterShortcuts("sidebar-view-settings","Settings",WaspUI.diplaySettingsMenu.bind(n),""),n.appendChild(n.settingsButton.element),WaspUI.mainPanel=t.mainElement,WaspUI.messages.addListener("initiator",function(e){var t=WaspUI.connections.add(e["initiator-from"],e["initiator-to"]),n=WaspUI.findNodeFromUrl(t.to),a=WaspUI.findNodeFromUrl(t.from);n&&a&&(a.addCalls(n.id),n.addCalledBy(a.id),t.connected=!0)}),WaspUI.messages.addListener("connection",function(e){!0===e["new-session"]&&(WaspUI.cql.delete("bypass","duration="+WaspUI.BYPASS_DURATION_SESSION),WaspUI.saveBypasses(WaspUI.BYPASS_DURATION_SESSION))}),WaspUI.messages.addListener("set-friendly",function(e){for(var t=e["set-friendly"],n=t.length;n--;)WaspUI.friendly.setGroup(t[n])}),WaspUI.messages.port=chrome.runtime.connect({name:"WASP.devtool-"+WaspUI.currentTab}),WaspUI.messages.port.onMessage.addListener(function(e){e["msg-type"]?WaspUI.messages.fireListener(e["msg-type"],e):console.log("unexpected message",e)}),WaspUI.messages.port.postMessage({"msg-type":"get-friendly","get-friendly":!0,response:function(e){WaspUI.friendly=e}})},WaspUI.doSearchAction=function(e,t){switch(WaspUI.doSearchAction.styles||(WaspUI.doSearchAction.styles=new Stylomatic),e){case WaspUI.doSearchAction.actions.PerformSearch:var n=t,a="",s="";return n.length&&(o=document.querySelectorAll('li[data-name*="'+n+'"] > span')).length?(o[0].scrollIntoView(),a='li[data-name]:not([data-name*="'+n+'"]):not(.connected):not(.selected):not(:hover) > span { width:36px !important;}',s='li[data-name*="'+n+'"] > span { background-color:lightgreen !important; }',console.info("found ",a,s),WaspUI.doSearchAction.styles.replace("find",s),WaspUI.doSearchAction.styles.replace("filter",a)):(WaspUI.doSearchAction.styles.remove("find"),WaspUI.doSearchAction.styles.remove("filter")),WaspUI.doSearchAction.results=o,WaspUI.doSearchAction.resultPosition=-1,el.length;case WaspUI.doSearchAction.actions.NextSearchResult:(o=WaspUI.doSearchAction.results)&&o.length&&(WaspUI.doSearchAction.resultPosition++,WaspUI.doSearchAction.resultPosition>=o.length&&(WaspUI.doSearchAction.resultPosition=0),o[WaspUI.doSearchAction.resultPosition].scrollIntoView(),o[WaspUI.doSearchAction.resultPosition].click());break;case WaspUI.doSearchAction.actions.PreviousSearchResult:var o;(o=WaspUI.doSearchAction.results)&&o.length&&(WaspUI.doSearchAction.resultPosition--,WaspUI.doSearchAction.resultPosition<0&&(WaspUI.doSearchAction.resultPosition=o.length-1),o[WaspUI.doSearchAction.resultPosition].scrollIntoView(),o[WaspUI.doSearchAction.resultPosition].click());break;case WaspUI.doSearchAction.actions.CancelSearch:WaspUI.doSearchAction.styles.remove("find"),WaspUI.doSearchAction.styles.remove("filter");break;default:console.log("unknown search action",e,t)}},WaspUI.doSearchAction.styles=null,WaspUI.doSearchAction.results=null,WaspUI.doSearchAction.resultPosition=-1,WaspUI.doSearchAction.actions=chrome.devtools.panels.SearchAction,WaspUI.displayNodeDetails=function(e){WaspUI.sidebarPanel.detailStack.element.classList.remove("hidden"),this.detailsButton.toggled=1,WaspUI.sidebarPanel.contentStack.element.classList.add("hidden"),this.contentButton.toggled=0},WaspUI.displayNodeContent=function(e){WaspUI.sidebarPanel.detailStack.element.classList.add("hidden"),this.detailsButton.toggled=0,WaspUI.sidebarPanel.contentStack.element.classList.remove("hidden"),this.contentButton.toggled=1},WaspUI.diplaySettingsMenu=function(e){function t(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_OVERRIDE,this.dataset.url,!1)}var n,a=new WebInspector.ContextMenu(e);if(a.appendItem("WASP Options",function(){WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:"/options.html"})}),a.appendItem("About WASP",function(){WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:"about.html"})}),a.appendSeparator(),WaspUI.events&&WaspUI.events.selectedNode&&(n=WaspUI.events.selectedNode,WaspUI.mainPanel&&WaspUI.mainPanel.currentContent&&WaspUI.mainPanel.currentContent.pageNode&&WaspUI.mainPanel.currentContent.pageNode!==n)){var s=0==n.id.indexOf("tags")?"tag":"script";a.appendItem("Hide this "+s,function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.url,!1)}.bind(n)),-1!==n.id.indexOf("blocked")||n.classList.contains("blocked")||n.classList.contains("override")||(a.appendItem("Block this "+s,function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_BLOCK,this.dataset.url,!1)}.bind(n)),"script"==s&&a.appendItem("Override this script",t.bind(n))),"script"==s&&a.appendItem("Override this script",t.bind(n)),a.appendSeparator(),a.appendItem("Hide this domain",function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.domain,!0)}.bind(n))}a.appendItem("Manage bypasses",function(){new WaspUI.ManageBypassesDialog}),a.show()},WaspUI.addTreeNodeController=function(e){var t=e.querySelector("span");e.removeChild(t);var n=document.createElement("input");n.type="checkbox",n.id="ux-node-"+e.id,n.setAttribute("checked","checked");var a=document.createElement("label");a.style.cssText=t.style.cssText,t.style.cssText="",a.setAttribute("for",n.id),a.appendChild(t),e.appendChild(n),e.appendChild(a),Object.defineProperties(n,{check:{enumerable:!0,value:function(e,t){if(!this.checked){if(this.checked=!0,e)for(var n=this.parentElement.querySelectorAll("ul input[type=checkbox][id^=ux-node-]"),a=n.length;a--;){n[a].checked=!0}if(!t){var s=document.createEvent("Event");s.initEvent("change",!0,!1),this.dispatchEvent(s)}}}},uncheck:{enumerable:!0,value:function(e,t){if(this.checked){if(this.checked=!1,e)for(var n=this.parentElement.querySelectorAll("ul input[type=checkbox][id^=ux-node-]"),a=n.length;a--;){n[a].checked=!1}if(!t){var s=document.createEvent("Event");s.initEvent("change",!0,!1),this.dispatchEvent(s)}}}},toggle:{enumerable:!0,value:function(e,t){var n=this.checked=!this.checked;if(e)for(var a=this.parentElement.querySelectorAll("ul input[type=checkbox][id^=ux-node-]"),s=a.length;s--;){a[s].checked=n}if(!t){var o=document.createEvent("Event");o.initEvent("change",!0,!1),this.dispatchEvent(o)}}}}),n.addEventListener("change",function(e){WaspUI.chron.doUntil(WaspUI.sizeConnectors,!1)})},WaspUI.addTreeNode=function(e,t,n,a,s){for(var o=document.createElement("li"),i=e;!i.classList.contains("tree")&&"li"!==i.tagName.toLowerCase();i=i.parentNode);i.id.length?o.id=i.id+"-"+t:o.id=t;var r=document.createElement("span");if(r.innerHTML=n,o.appendChild(r),s&&s.parentNode===e)e.insertBefore(o,s);else if(!a&&e.children.length){var c=insertionIndexForObjectInListSortedByFunction(o,e.children,function(e,t){return e.innerText<t.innerText?-1:e.innerText>t.innerText?1:0});c<e.children.length?e.insertBefore(o,e.children[c]):e.appendChild(o)}else e.appendChild(o);var l=e.label.dataset;return l.childcount=l.childcount?Number(l.childcount)+1:1,o.branchParent=null,Object.defineProperties(o,{rootNode:{enumerable:!0,get:function(){for(var e=this.parentNode;!e.classList.contains("tree");e=e.parentNode);return e}},controller:{enumerable:!0,get:function(){for(var e=null,t=this.parentNode;!t.classList.contains("tree");t=t.parentNode)if("li"===t.tagName.toLowerCase()){e=t.querySelector("input[type=checkbox][id^=ux-node-]");break}return e}},visible:{enumerable:!0,get:function(){var e=this.controller,t=!e||e.checked;if(t)for(var n=this.parentNode;!n.classList.contains("tree");n=n.parentNode)if("li"===n.tagName.toLowerCase()){t=n.visible;break}return t}},show:{enumerable:!0,value:function(){var e=this.controller;e&&e.check();for(var t=this.parentNode;!t.classList.contains("tree");t=t.parentNode)if("li"===t.tagName.toLowerCase()){v=t.show();break}}},addBranch:{enumerable:!0,value:function(e,t,n){this.branchElement||(WaspUI.addTreeNodeController(this),this.branchElement=document.createElement("ul"),this.branchElement.label=this.querySelector("label"),this.branchElement.label.dataset.childcount=0,this.branches={},this.branchIds=[],this.appendChild(this.branchElement));for(var a=e,s=1;this.branches[a];)a=e+"-"+s++;var o=WaspUI.addTreeNode(this.branchElement,a,t,!!n);return o.branchParent=this,this.branches[a]=o,this.branchIds.push(a),o}},showConnections:{enumerable:!0,value:function(e){if(e)for(var t=document.querySelectorAll(".connect"),n=t.length;n--;){var a=t[n];document.querySelector("#"+a.dataset.to).classList.remove("connected"),document.querySelector("#"+a.dataset.from).classList.remove("connected"),a.parentElement.removeChild(a)}for(var s=this.dataset.url,o=WaspUI.findConnections(s)||[],i=(n=-1,o.length);++n<i;){var r,c=o[n];c.from==s?(r=WaspUI.findNodeFromUrl(c.to))&&(c.connected=!0,r.show(),WaspUI.addConnector(r.id,this.id)):c.to==s&&(r=WaspUI.findNodeFromUrl(c.from))&&(c.connected=!0,r.show(),WaspUI.addConnector(this.id,r.id))}}},hideConnections:{enumerable:!0,value:function(){var e,t=document.querySelector('[data-to="'+this.id+'"], [data-from="'+this.id+'"]');for(e=t.length;e--;)t[e].parentElement&&(document.querySelector("#"+t[e].dataset.to).classList.remove("connected"),document.querySelector("#"+t[e].dataset.from).classList.remove("connected"),t[e].parentElement.removeChild(t[e]))}},addCalls:{enumerable:!0,value:function(e){e&&e===e+""&&(this.dataset.calls?-1==this.dataset.calls.indexOf(e)&&(this.dataset.calls+=" "+e):this.dataset.calls=e)}},addCalledBy:{enumerable:!0,value:function(e){e&&e===e+""&&(this.dataset.calledby?-1==this.dataset.calledby.indexOf(e)&&(this.dataset.calls+=" "+e):this.dataset.calledby=e)}}}),o},WaspUI.addConnector=function(e,t,n){if(!document.querySelector('.connect[data-to="'+e+'"][data-from="'+t+'"]')){var a=document.createElement("div");a.appendChild(document.createElement("span")),a.appendChild(document.createElement("span")),a.dataset.to=e,a.dataset.from=t,a.dataset.cCount=n,a.className="connect",WaspUI.mainPanel.currentContent.element.insertBefore(a,WaspUI.mainPanel.currentContent.firstChild),WaspUI.chron.doUntil(WaspUI.sizeConnectors,!1)}},WaspUI.sizeConnectors=function(){var e=document.querySelectorAll(".connect"),t=[];if(!e.length)return!1;for(var n=e.length;n--;t.unshift(e[n]));var a=t[0].parentElement.totalOffset();for(n=t.length;n--;){var s=t[n];s.fr||(s.fr=document.querySelector("#"+s.dataset.from)),s.fr.classList.add("connected"),s.to||(s.to=document.querySelector("#"+s.dataset.to)),s.to.classList.add("connected");if(s.fr.visible&&s.to.visible){var o=7*n,i=s.fr.totalOffset(),r=i.left+s.fr.offsetWidth>>0,c=i.top+.5*s.fr.offsetHeight>>0,l=s.to.totalOffset(),d=l.left+s.to.offsetWidth>>0,p=l.top+.5*s.to.offsetHeight>>0,u=Math.min(r,d)-a.left,h=Math.min(c,p)-a.top,I="left: "+u+"px; ";if(I+="top: "+h+"px; ",I+="width: "+(Math.max(r+o,d+o)-a.left-u)+"px; ",(I+="height: "+(Math.max(c,p)-a.top-h)+"px; ")!=s.getAttribute("style")){s.stable=0;var U="connect";if((U+=c<p?" st bl tl":" sb bl tl")!=s.className){s.className=U;s.querySelector("span:first-child")}s.setAttribute("style",I)}else++s.stable>25&&(s.stable=0,t.splice(n,1))}else s.parentElement&&s.fr.classList.remove("connected"),s.to.classList.remove("connected"),s.parentElement.removeChild(s),t.splice(n,1)}return!!t.length},WaspUI.addTree=function(e){var t=document.createElement("ul");return e.appendChild(t),t.className="tree",t.branches={},t.branchIds=[],t.label=document.createElement("label"),Object.defineProperties(t,{addBranch:{enumerable:!0,value:function(e,t,n,a,s){var o=WaspUI.addTreeNode(this,e,t,!0,a);return o.className=n?"asc":"desc",this.branches[e]=o,this.branchIds.push(e),o}},prune:{eunmerable:!0,value:function(){for(var e=this.children,t=e.length;t--;)this.removeChild(e[t])}}}),t},WaspUI.hideTreeNode=function(e,t,n){(e.classList.contains("selected")||e.querySelector(".selected"))&&WaspUI.mainPanel&&WaspUI.mainPanel.currentContent&&WaspUI.mainPanel.currentContent.pageNode&&WaspUI.mainPanel.currentContent.pageNode.click();var a=document.createElement("template");a.id=e.id+"-hide",a.dataset[n]=t,e.parentNode.insertBefore(a,e),a.content.appendChild(e)},WaspUI.unhideTreeNode=function(e,t){var n=document.querySelector("template[data-"+t+'="'+e+'"]');return!!n&&(n.parentNode.insertBefore(n.content.firstChild,n),n.parentNode.removeChild(n),!0)};WaspUI.friendly=[],WaspUI.friendly.groups={},WaspUI.friendly.cookieGroups={},WaspUI.friendly.tests={},WaspUI.friendly.testKeys=[],WaspUI.friendly.setGroup=function(e){var t=WaspUI.friendly;WaspUI.cql.exists("friendly")||WaspUI.cql.define("friendly","host,file,id"),(e.id&&e.id===e.id+""&&e.use&&e.use===e.use+""||e.title&&e.title===e.title+""&&e.tags)&&(e.id in t.groups?(t[t.groups[e.id]]=e,e.host.length&&e.file.length?WaspUI.cql.update("friendly",{host:e.host.join(" "),file:e.file.join(" ")},"id="+e.id):e.host.length?WaspUI.cql.update("friendly",{host:e.host.join(" "),file:"*"},"id="+e.id):e.file.length?WaspUI.cql.update("friendly",{host:"*",file:e.file.join(" ")},"id="+e.id):e.test&&e.test.length&&(WaspUI.friendly.tests[e.use||e.id]=new RegExp(e.test),WaspUI.friendly.testKeys=Object.keys(WaspUI.friendly.tests))):(t.groups[e.id]=t.length,t.push(e),e.host.length&&e.file.length?WaspUI.cql.insert("friendly",{host:e.host.join(" "),file:e.file.join(" "),id:e.id}):e.host.length?WaspUI.cql.insert("friendly",{host:e.host.join(" "),file:"*",id:e.id}):e.file.length?WaspUI.cql.insert("friendly",{host:"*",file:e.file.join(" "),id:e.id}):e.test&&e.test.length&&(WaspUI.friendly.tests[e.use||e.id]=new RegExp(e.test),WaspUI.friendly.testKeys=Object.keys(WaspUI.friendly.tests))),e.test&&e.test.length&&(e.test=new RegExp(e.test)),e.cookies&&Object.keys(e.cookies).length&&(WaspUI.friendly.cookieGroups[e.id]=e))},WaspUI.friendly.intersectTags=function(e,t,s,l,n){var r,o,p,a,d,f=[];if(!e||!Object.keys(e).length)return f;for(r=t.length;r--;)if(a=(o=t[r])[s].replace(/\d+/g,"*"),i=o[s].match(/\d+/g),a in e){if("skip"!==(p=e[a]).group){try{d=decodeURIComponent(o[l])}catch(e){try{d=unescape(o[l])}catch(e){d=o[l]}}if(label=p.label,group=p.group,i)for(var h=0,u=i.length;h<u;h++)label=/\!/.test(label)?label.replace(/\!/,""):label.replace(/\*/,i[h]),group=group.replace(/\*/,i[h]);f.push({name:label+" ("+o[s]+")",value:d,group:group,help:p.help})}}else if(n){try{d=decodeURIComponent(o[l])}catch(e){try{d=unescape(o[l])}catch(e){d=o[l]}}f.push({name:"("+o[s]+")",value:d,group:"{Unknown Variables}"})}return f},WaspUI.friendly.findGroup=function(e,t,s){var i=WaspUI.cql.select("friendly",'host~="'+e+'",file~="'+t+'"||host~="'+e+'",file="*"||host="*",file~="'+t+'"'),l=i&&i.length?i[0].use||i[0].id:null;if(!l)for(var n=(i=WaspUI.friendly).testKeys.length;n--;)if(i.tests[i.testKeys[n]].test(s)){l=i.testKeys[n];break}return this.getGroup(l)},WaspUI.friendly.getGroup=function(e){var t=WaspUI.friendly;return e&&e in t.groups?t[t.groups[e]]:{id:e,title:"",version:0,host:[],file:[],tags:{},cookies:{}}};WebInspector.SoftContextMenu=function(e,t){this._items=e,this._parentMenu=t},WebInspector.SoftContextMenu.prototype={show:function(e,t){this._x=e.x,this._y=e.y,this._time=(new Date).getTime();for(var n,s=e.pageX,i=e.pageY,u=e.target;u&&window!==u.ownerDocument.defaultView;){var h=u.ownerDocument.defaultView.frameElement;i+=h.totalOffsetTop(),s+=h.totalOffsetLeft(),u=h}this._contextMenuElement=document.createElement("div"),this._contextMenuElement.className="soft-context-menu",this._contextMenuElement.tabIndex=0,t&&(s=(n=e.currentTarget.getBoundingClientRect()).left,i=n.bottom),this._contextMenuElement.style.top=i+"px",this._contextMenuElement.style.left=s+"px",this._contextMenuElement.addEventListener("mouseup",consumeEvent,!1),this._contextMenuElement.addEventListener("keydown",this._menuKeyDown.bind(this),!1);for(var o=0;o<this._items.length;++o)this._contextMenuElement.appendChild(this._createMenuItem(this._items[o]));this._parentMenu?this._parentMenu._parentGlassPaneElement().appendChild(this._contextMenuElement):(this._glassPaneElement=document.createElement("div"),this._glassPaneElement.className="soft-context-menu-glass-pane",this._glassPaneElement.tabIndex=0,this._glassPaneElement.addEventListener("mouseup",this._glassPaneMouseUp.bind(this),!1),this._glassPaneElement.appendChild(this._contextMenuElement),document.body.appendChild(this._glassPaneElement),this._focus()),document.body.offsetWidth<this._contextMenuElement.offsetLeft+this._contextMenuElement.offsetWidth&&(this._contextMenuElement.style.left=t?Math.max(0,n.right-this._contextMenuElement.offsetWidth)+"px":s-this._contextMenuElement.offsetWidth+"px"),document.body.offsetHeight<this._contextMenuElement.offsetTop+this._contextMenuElement.offsetHeight&&(this._contextMenuElement.style.top=t?Math.max(0,n.top-this._contextMenuElement.offsetHeight)+"px":document.body.offsetHeight-this._contextMenuElement.offsetHeight+"px"),e.consume(!0)},_parentGlassPaneElement:function(){return this._glassPaneElement?this._glassPaneElement:this._parentMenu?this._parentMenu._parentGlassPaneElement():null},_createMenuItem:function(e){if("separator"===e.type)return this._createSeparator();if("subMenu"===e.type)return this._createSubMenu(e);var t=document.createElement("div");t.className="soft-context-menu-item";var n=document.createElement("span");return n.textContent="✓ ",n.className="soft-context-menu-item-checkmark",e.checked||(n.style.opacity="0"),t.appendChild(n),t.appendChild(document.createTextNode(e.label)),t.addEventListener("mousedown",this._menuItemMouseDown.bind(this),!1),t.addEventListener("mouseup",this._menuItemMouseUp.bind(this),!1),t.addEventListener("mouseover",this._menuItemMouseOver.bind(this),!1),t.addEventListener("mouseout",this._menuItemMouseOut.bind(this),!1),t._actionId=e.id,t},_createSubMenu:function(e){var t=document.createElement("div");t.className="soft-context-menu-item",t._subItems=e.subItems;var n=document.createElement("span");n.textContent="✓ ",n.className="soft-context-menu-item-checkmark",n.style.opacity="0",t.appendChild(n);var s=document.createElement("span");return s.textContent="▶",s.className="soft-context-menu-item-submenu-arrow",t.appendChild(document.createTextNode(e.label)),t.appendChild(s),t.addEventListener("mousedown",this._menuItemMouseDown.bind(this),!1),t.addEventListener("mouseup",this._menuItemMouseUp.bind(this),!1),t.addEventListener("mouseover",this._menuItemMouseOver.bind(this),!1),t.addEventListener("mouseout",this._menuItemMouseOut.bind(this),!1),t},_createSeparator:function(){var e=document.createElement("div");return e.className="soft-context-menu-separator",e._isSeparator=!0,e.addEventListener("mouseover",this._hideSubMenu.bind(this),!1),e.createChild("div","separator-line"),e},_menuItemMouseDown:function(e){e.consume(!0)},_menuItemMouseUp:function(e){this._triggerAction(e.target,e),e.consume()},_focus:function(){this._contextMenuElement.focus()},_triggerAction:function(e,t){if(!e._subItems)return this._discardMenu(!0,t),void(void 0!==e._actionId&&(WebInspector.contextMenuItemSelected(e._actionId),delete e._actionId));this._showSubMenu(e,t),t.consume()},_showSubMenu:function(e,t){e._subMenuTimer&&(clearTimeout(e._subMenuTimer),delete e._subMenuTimer),this._subMenu||(this._subMenu=new WebInspector.SoftContextMenu(e._subItems,this),this._subMenu.show(this._buildMouseEventForSubMenu(e)))},_buildMouseEventForSubMenu:function(e){var t=e.offsetWidth-3,n=e.offsetTop-1;return{x:this._x+t,y:this._y+n,pageX:parseInt(this._contextMenuElement.style.left,10)+t,pageY:parseInt(this._contextMenuElement.style.top,10)+n,consume:function(){}}},_hideSubMenu:function(){this._subMenu&&(this._subMenu._discardSubMenus(),this._focus())},_menuItemMouseOver:function(e){this._highlightMenuItem(e.target)},_menuItemMouseOut:function(e){if(this._subMenu&&e.relatedTarget){var t=e.relatedTarget;(this._contextMenuElement.isSelfOrAncestor(t)||t.hasStyleClass("soft-context-menu-glass-pane"))&&this._highlightMenuItem(null)}else this._highlightMenuItem(null)},_highlightMenuItem:function(e){this._highlightedMenuItemElement!==e&&(this._hideSubMenu(),this._highlightedMenuItemElement&&(this._highlightedMenuItemElement.removeStyleClass("soft-context-menu-item-mouse-over"),this._highlightedMenuItemElement._subItems&&this._highlightedMenuItemElement._subMenuTimer&&(clearTimeout(this._highlightedMenuItemElement._subMenuTimer),delete this._highlightedMenuItemElement._subMenuTimer)),this._highlightedMenuItemElement=e,this._highlightedMenuItemElement&&(this._highlightedMenuItemElement.addStyleClass("soft-context-menu-item-mouse-over"),this._contextMenuElement.focus(),this._highlightedMenuItemElement._subItems&&!this._highlightedMenuItemElement._subMenuTimer&&(this._highlightedMenuItemElement._subMenuTimer=setTimeout(this._showSubMenu.bind(this,this._highlightedMenuItemElement,this._buildMouseEventForSubMenu(this._highlightedMenuItemElement)),150))))},_highlightPrevious:function(){for(var e=this._highlightedMenuItemElement?this._highlightedMenuItemElement.previousSibling:this._contextMenuElement.lastChild;e&&e._isSeparator;)e=e.previousSibling;e&&this._highlightMenuItem(e)},_highlightNext:function(){for(var e=this._highlightedMenuItemElement?this._highlightedMenuItemElement.nextSibling:this._contextMenuElement.firstChild;e&&e._isSeparator;)e=e.nextSibling;e&&this._highlightMenuItem(e)},_menuKeyDown:function(e){switch(e.keyIdentifier){case"Up":this._highlightPrevious();break;case"Down":this._highlightNext();break;case"Left":this._parentMenu&&(this._highlightMenuItem(null),this._parentMenu._focus());break;case"Right":if(!this._highlightedMenuItemElement)break;this._highlightedMenuItemElement._subItems&&(this._showSubMenu(this._highlightedMenuItemElement,this._buildMouseEventForSubMenu(this._highlightedMenuItemElement)),this._subMenu._focus(),this._subMenu._highlightNext());break;case"U+001B":this._discardMenu(!0,e);break;case"Enter":if(!isEnterKey(e))break;case"U+0020":this._highlightedMenuItemElement&&this._triggerAction(this._highlightedMenuItemElement,e)}e.consume(!0)},_glassPaneMouseUp:function(e){e.x===this._x&&e.y===this._y&&(new Date).getTime()-this._time<300||(this._discardMenu(!0,e),e.consume())},_discardMenu:function(e,t){if(!this._subMenu||e)if(this._glassPaneElement){var n=this._glassPaneElement;delete this._glassPaneElement,document.body.removeChild(n),this._parentMenu&&(delete this._parentMenu._subMenu,e&&this._parentMenu._discardMenu(e,t)),t&&t.consume(!0)}else this._parentMenu&&this._contextMenuElement.parentElement&&(this._discardSubMenus(),e&&this._parentMenu._discardMenu(e,t),t&&t.consume(!0))},_discardSubMenus:function(){this._subMenu&&this._subMenu._discardSubMenus(),this._contextMenuElement.parentElement&&this._contextMenuElement.parentElement.removeChild(this._contextMenuElement),this._parentMenu&&delete this._parentMenu._subMenu}};WebInspector.ContextMenuItem=function(e,t,n,s,i){this._type=t,this._label=n,this._disabled=s,this._checked=i,this._contextMenu=e,"item"!==t&&"checkbox"!==t||(this._id=e.nextId())},WebInspector.ContextMenuItem.prototype={id:function(){return this._id},type:function(){return this._type},isEnabled:function(){return!this._disabled},setEnabled:function(e){this._disabled=!e},_buildDescriptor:function(){switch(this._type){case"item":return{type:"item",id:this._id,label:this._label,enabled:!this._disabled};case"separator":return{type:"separator"};case"checkbox":return{type:"checkbox",id:this._id,label:this._label,checked:!!this._checked,enabled:!this._disabled}}}},WebInspector.ContextSubMenuItem=function(e,t,n){WebInspector.ContextMenuItem.call(this,e,"subMenu",t,n),this._items=[]},WebInspector.ContextSubMenuItem.prototype={appendItem:function(e,t,n){var s=new WebInspector.ContextMenuItem(this._contextMenu,"item",e,n);return this._pushItem(s),this._contextMenu._setHandler(s.id(),t),s},appendSubMenuItem:function(e,t){var n=new WebInspector.ContextSubMenuItem(this._contextMenu,e,t);return this._pushItem(n),n},appendCheckboxItem:function(e,t,n,s){var i=new WebInspector.ContextMenuItem(this._contextMenu,"checkbox",e,s,n);return this._pushItem(i),this._contextMenu._setHandler(i.id(),t),i},appendSeparator:function(){this._items.length&&(this._pendingSeparator=!0)},_pushItem:function(e){this._pendingSeparator&&(this._items.push(new WebInspector.ContextMenuItem(this._contextMenu,"separator")),delete this._pendingSeparator),this._items.push(e)},isEmpty:function(){return!this._items.length},_buildDescriptor:function(){for(var e={type:"subMenu",label:this._label,enabled:!this._disabled,subItems:[]},t=0;t<this._items.length;++t)e.subItems.push(this._items[t]._buildDescriptor());return e},__proto__:WebInspector.ContextMenuItem.prototype},WebInspector.ContextMenu=function(e){WebInspector.ContextSubMenuItem.call(this,this,""),this._event=e,this._handlers={},this._id=0},WebInspector.ContextMenu.prototype={nextId:function(){return this._id++},show:function(){var e=this._buildDescriptor();e.length&&(WebInspector._contextMenu=this,new WebInspector.SoftContextMenu(e).show(this._event,!0),this._event.consume())},showSoftMenu:function(){var e=this._buildDescriptor();e.length&&(WebInspector._contextMenu=this,new WebInspector.SoftContextMenu(e).show(this._event,!0));this._event.consume()},_setHandler:function(e,t){t&&(this._handlers[e]=t)},_buildDescriptor:function(){for(var e=[],t=0;t<this._items.length;++t)e.push(this._items[t]._buildDescriptor());return e},_itemSelected:function(e){this._handlers[e]&&this._handlers[e].call(this)},appendApplicableItems:function(e){for(var t=0;t<WebInspector.ContextMenu._providers.length;++t){var n=WebInspector.ContextMenu._providers[t];this.appendSeparator(),n.appendApplicableItems(this._event,this,e),this.appendSeparator()}},__proto__:WebInspector.ContextSubMenuItem.prototype},WebInspector.ContextMenu.Provider=function(){},WebInspector.ContextMenu.Provider.prototype={appendApplicableItems:function(e,t,n){}},WebInspector.ContextMenu.registerProvider=function(e){WebInspector.ContextMenu._providers.push(e)},WebInspector.ContextMenu._providers=[],WebInspector.contextMenuItemSelected=function(e){WebInspector._contextMenu&&WebInspector._contextMenu._itemSelected(e)},WebInspector.contextMenuCleared=function(){};WaspUI.BypassNodeDialog=function(e,s,t,i){this.node=e,this.gp=new WebInspector.GlassPane;for(var n=document.querySelector("#bypass-node-template").content.cloneNode(!0),a=0;1!=n.childNodes[a].nodeType;)a++;this.element=n.childNodes[a],this.durationSet=n.querySelector("#bypass-node-duration"),this.scopeSet=n.querySelector("#bypass-node-scope"),this.overrideSet=this.overrideFile=this.overrideUrl=null,n.querySelector(".node-value").innerText=this.actionUrl=t.split(/#|\?/)[0],this.domain=i;var o=n.querySelectorAll("input[name='duration']");for(a=o.length;a--;)o[a].addEventListener("click",this.events.onDurationClick.bind(this));for(a=(o=n.querySelectorAll(".node-type-long")).length;a--;)o[a].innerText=i?"a domain":"a file or tag";var l="",r=this.manageAction=n.querySelector("#action-manage");switch(r.addEventListener("click",this.events.onManageClick.bind(this)),(r=this.cancelAction=n.querySelector("#action-cancel")).addEventListener("click",this.events.onCancelClick.bind(this)),r=this.applyAction=n.querySelector("#action-apply"),s){case WaspUI.BYPASS_TYPE_HIDE:r.addEventListener("click",this.events.onApplyHideClick.bind(this)),n.querySelector("#bypass-node-occurrence").classList.add("hidden"),l="Hide",(r=n.querySelector("#bypass-node-override")).parentNode.removeChild(r);break;case WaspUI.BYPASS_TYPE_BLOCK:r.addEventListener("click",this.events.onApplyBlockClick.bind(this)),l="Block",(r=n.querySelector("#bypass-node-override")).parentNode.removeChild(r);break;case WaspUI.BYPASS_TYPE_OVERRIDE:r.addEventListener("click",this.events.onApplyOverrideClick.bind(this)),l="Override",this.overrideSet=r=n.querySelector("#bypass-node-override"),this.overrideUrl=n.querySelector("#bypass-node-override-url"),r.classList.remove("hidden")}for(a=(o=n.querySelectorAll(".bypass-type")).length;a--;)o[a].innerText=l;r=this.element,this.gp.element.appendChild(r)},WaspUI.BypassNodeDialog.prototype={events:{onManageClick:function(e){this.events.onCancelClick.call(this,e,!0);new WaspUI.ManageBypassesDialog},onCancelClick:function(e,s){this.element.parentElement.removeChild(this.element),!s&&this.gp&&(this.gp.dispose(),delete this.gp)},onApplyHideClick:function(e){var s,t,i,n,a,o,l,r,d=this.element;if(!d.querySelector("#bypass-node-duration-never").checked)if(s=WaspUI.mainPanel.currentContent,t=4,a=WaspUI.BYPASS_TAB_TRACKED,d.querySelector("#bypass-node-duration-window").checked?(t=1,a=WaspUI.currentTab):d.querySelector("#bypass-node-duration-session").checked&&(t=2),i=4,n="",d.querySelector("#bypass-node-scope-page").checked?(i=1,n=s.url):d.querySelector("#bypass-node-scope-domain").checked&&(i=2,n=s.domain),WaspUI.addBypass(WaspUI.BYPASS_TYPE_HIDE,this.actionUrl,this.domain,t,i,n,a),this.domain){for(l=WaspUI.mainPanel.contentPanels.length;l--;)if(s=WaspUI.mainPanel.contentPanels[l],4===i||2===i&&s.domain===n||1===i&&s.url===n)for(r=(o=WaspUI.findDomainNodes(this.actionUrl,s)).length;r--;WaspUI.hideTreeNode(o[r],this.actionUrl,"domain"));WaspUI.sizeConnectors()}else for(l=WaspUI.mainPanel.contentPanels.length;l--;)if(s=WaspUI.mainPanel.contentPanels[l],4===i||2===i&&s.domain===n||1===i&&s.url===n)for(r=(o=WaspUI.findNodelistFromUrl(this.actionUrl,s,!0)).length;r--;WaspUI.hideTreeNode(o[r],this.actionUrl,"url"));this.events.onCancelClick.call(this,e)},onApplyBlockClick:function(e){var s,t,i,n,o,l=this.element;if(!l.querySelector("#bypass-node-duration-never").checked)for(s=WaspUI.mainPanel.currentContent,i=l.querySelector("#bypass-node-always").checked?WaspUI.BYPASS_TAB_ALL:WaspUI.BYPASS_TAB_TRACKED,t=4,l.querySelector("#bypass-node-duration-window").checked?(t=1,i=WaspUI.currentTab):l.querySelector("#bypass-node-duration-session").checked&&(t=2),n=4,o="",l.querySelector("#bypass-node-scope-page").checked?(n=1,o=s.url):l.querySelector("#bypass-node-scope-domain").checked&&(n=2,o=s.domain),WaspUI.addBypass(WaspUI.BYPASS_TYPE_BLOCK,this.actionUrl,this.domain,t,n,o,i),a=WaspUI.mainPanel.contentPanels.length;a--;)if(s=WaspUI.mainPanel.contentPanels[a],4===n||2===n&&s.domain===o||1===n&&s.url===o)for(nl=WaspUI.findNodelistFromUrl(this.actionUrl,s,!0),b=nl.length;b--;nl[b].classList.add("blocked"));this.events.onCancelClick.call(this,e)},onApplyOverrideClick:function(e){var s,t,i,n,o,l,r,d=this.element;if(!d.querySelector("#bypass-node-duration-never").checked){if(l=WaspUI.BYPASS_OVERRIDE_URL,!(r=d.querySelector("#bypass-node-override-url").value))return(s=d.querySelector(".error")).innerText="Please supply an override script url.",s.classList.add("popup"),d.querySelector("#bypass-node-override-url").focus(),void window.setTimeout(function(){s.classList.remove("popup")},2e3);if(r!==r.parseUrl().href)return(s=d.querySelector(".error")).innerText="Please supply a valid override script url.",s.classList.add("popup"),d.querySelector("#bypass-node-override-url").focus(),void window.setTimeout(function(){s.classList.remove("popup")},2e3);for(s=WaspUI.mainPanel.currentContent,i=d.querySelector("#bypass-node-always").checked?WaspUI.BYPASS_TAB_ALL:WaspUI.BYPASS_TAB_TRACKED,t=4,d.querySelector("#bypass-node-duration-window").checked?(t=1,i=WaspUI.currentTab):d.querySelector("#bypass-node-duration-session").checked&&(t=2),n=4,o="",d.querySelector("#bypass-node-scope-page").checked?(n=1,o=s.url):d.querySelector("#bypass-node-scope-domain").checked&&(n=2,o=s.domain),WaspUI.addBypass(WaspUI.BYPASS_TYPE_OVERRIDE,this.actionUrl,this.domain,t,n,o,i,l,r),a=WaspUI.mainPanel.contentPanels.length;a--;)if(s=WaspUI.mainPanel.contentPanels[a],4===n||2===n&&s.domain===o||1===n&&s.url===o)for(nl=WaspUI.findNodelistFromUrl(this.actionUrl,s,!0),b=nl.length;b--;nl[b].classList.add("override"));}this.events.onCancelClick.call(this,e)},onDurationClick:function(e){"0"===e.target.value?this.scopeSet.disabled=!0:"1"===e.target.value?(this.scopeSet.disabled=!1,this.element.querySelector("#bypass-node-occurrence").classList.add("disabled"),this.element.querySelector("#bypass-node-always").disabled=!0):(this.scopeSet.disabled=!1,this.element.querySelector("#bypass-node-occurrence").classList.remove("disabled"),this.element.querySelector("#bypass-node-always").disabled=!1),this.overrideSet&&(this.overrideSet.disabled=this.scopeSet.disabled)},onOverrideTypeChange:function(e){var s=this.overrideFile,t=this.overrideUrl;e.target.value==WaspUI.BYPASS_OVERRIDE_FILE?(s.classList.remove("hidden"),s.disabled=!1,t.classList.add("hidden"),t.disabled=!0):(t.classList.remove("hidden"),t.disabled=!1,s.classList.add("hidden"),s.disabled=!0)}}},WaspUI.ManageBypassesDialog=function(){ga("send","pageview",{page:"/bypass.htm",title:"Manage Bypasses"}),this.gp=new WebInspector.GlassPane;for(var e=document.querySelector("#manage-bypass-template").content.cloneNode(!0),s=0;1!==e.childNodes[s].nodeType;)s++;this.element=e.childNodes[s],this.toggleStyles=new Stylomatic(e.querySelector("style").sheet);var t=this.domainToggle=e.querySelector("#manage-bypasses-view-domain");t.addEventListener("click",this.events.onDomainToggleClick.bind(this)),(t=this.scriptToggle=e.querySelector("#manage-bypasses-view-script")).addEventListener("click",this.events.onScriptToggleClick.bind(this)),(t=this.hideToggle=e.querySelector("#manage-bypasses-view-hide")).addEventListener("click",this.events.onHideToggleClick.bind(this)),(t=this.blockToggle=e.querySelector("#manage-bypasses-view-block")).addEventListener("click",this.events.onBlockToggleClick.bind(this)),(t=this.overrideToggle=e.querySelector("#manage-bypasses-view-override")).addEventListener("click",this.events.onOverrideToggleClick.bind(this)),(t=this.cancelAction=e.querySelector("#action-cancel")).addEventListener("click",this.events.onCancelClick.bind(this)),(t=this.applyAction=e.querySelector("#action-apply")).addEventListener("click",this.events.onApplyClick.bind(this)),t=e.querySelector("#manage-bypasses-elements"),this.loadBypasses(t,WaspUI.cql.select("bypass","*","isDomain [true|false],url,type [hide|block|override],scope desc")),t=this.element,this.gp.element.appendChild(t)},WaspUI.ManageBypassesDialog.prototype={loadBypasses:function(e,s){var t,i,n,a,o,l,r,d,c,p,h=0,u=0,y="";for(i=-1,n=s.length;++i<n;){if(a=s[i],p=e.querySelector("template").content.cloneNode(!0),y!==a.url){y=a.url,t=e,o=p.querySelector("fieldset"),u=0;var g="-"+ ++h;o.id=o.id.replace("-e",g),"true"===a.isDomain?(o.classList.add("domain"),p.querySelector(".node-type").innerText="Domain"):(o.classList.add("script"),p.querySelector(".node-type").innerText="File"),p.querySelector(".node-value").innerText=a.url,o=p.querySelector("#manage-bypasses-e-r")}else p=o=p.querySelector("#manage-bypasses-e-r"),t=e.querySelector("fieldset:last-of-type");for(c=g+"-"+ ++u,o.id=o.id.replace("-e-r",c),o.classList.add(a.type),(o=p.querySelector(".bypass-type")).innerText=a.type.substring(0,1).toUpperCase()+a.type.substring(1),"hide"!==a.type?p.querySelector("#manage-bypasses-e-r-occurrence").classList.remove("hidden"):(r=p.querySelector("#manage-bypasses-e-r-occurrence")).parentNode.removeChild(r),"override"===a.type?p.querySelector("#manage-bypasses-e-r-override").classList.remove("hidden"):(r=p.querySelector("#manage-bypasses-e-r-override")).parentNode.removeChild(r),d=(l=p.querySelectorAll("input[name],select[name]")).length;d--;)(r=l[d]).name in a&&("duration"===r.name?(r.value=a[r.name],r.addEventListener("change",this.events.onDurationChange.bind(r)),this.events.onDurationChange.call(r)):"always"===r.name?r.checked=a.tab===WaspUI.BYPASS_TAB_ALL:r.value=a[r.name]);for(d=(l=p.querySelectorAll('[id^="manage-bypasses-e-r-"]')).length;d--;)(r=l[d]).id=r.id.replace("-e-r",c);"1"===a.scope?(p.querySelector(".scope-type").innerText="this Page: ",p.querySelector(".scope-value").innerText=a.scopeUrl):"2"===a.scope?(p.querySelector(".scope-type").innerText="this Domain: ",p.querySelector(".scope-value").innerText=a.scopeUrl):p.querySelector(".scope-type").innerText="all sites.",t.appendChild(p)}},events:{onCancelClick:function(e){this.element.parentElement.removeChild(this.element),this.gp.dispose(),delete this.gp},onDomainToggleClick:function(e){"on"===this.domainToggle.value?(this.toggleStyles.add("domain","fieldset.domain { display:none; }"),this.domainToggle.value="off"):(this.toggleStyles.remove("domain"),this.domainToggle.value="on")},onScriptToggleClick:function(e){"on"===this.scriptToggle.value?(this.toggleStyles.add("script","fieldset.script { display:none; }"),this.scriptToggle.value="off"):(this.toggleStyles.remove("script"),this.scriptToggle.value="on")},onHideToggleClick:function(e){"on"===this.hideToggle.value?(this.toggleStyles.add("hide",".rule.hide { display:none; }"),this.hideToggle.value="off"):(this.toggleStyles.remove("hide"),this.hideToggle.value="on")},onBlockToggleClick:function(e){"on"===this.blockToggle.value?(this.toggleStyles.add("block",".rule.block { display:none; }"),this.blockToggle.value="off"):(this.toggleStyles.remove("block"),this.blockToggle.value="on")},onOverrideToggleClick:function(e){"on"===this.overrideToggle.value?(this.toggleStyles.add("override",".rule.override { display:none; }"),this.overrideToggle.value="off"):(this.toggleStyles.remove("override"),this.overrideToggle.value="on")},onApplyClick:function(e){var s,t,i,n,a,o,l,r;for(s=this.element.querySelectorAll('.rule[id^="manage-bypasses-"]'),WaspUI.cql.delete("bypass","*"),i=s.length;i--;){for(t=WaspUI.cql.defaultValues("bypass"),a=(n=s[i].querySelectorAll("input[name],select[name]")).length;a--;)"always"===(o=n[a]).name?t.tab=o.checked?WaspUI.BYPASS_TAB_ALL:WaspUI.BYPASS_TAB_TRACKED:o.name in t&&(t[o.name]=o.value);if("1"===t.duration&&(t.tab=WaspUI.currentTab),"0"!==t.duration)WaspUI.addBypass(t.type,t.url,t.isDomain,t.duration,t.scope,t.scopeUrl,t.tab,t.override,t.overrideUrl);else if("hide"===t.type)if("true"===t.isDomain){for(l=WaspUI.mainPanel.contentPanels.length;l--;)if(r=WaspUI.mainPanel.contentPanels[l],"4"===t.scope||"2"===t.scope&&r.domain===t.scopeUrl||"1"===t.scope&&r.url===t.scopeUrl)for(;WaspUI.unhideTreeNode(t.url,"domain"););}else for(l=WaspUI.mainPanel.contentPanels.length;l--;)if(r=WaspUI.mainPanel.contentPanels[l],"4"===t.scope||"2"===t.scope&&r.domain===t.scopeUrl||"1"===t.scope&&r.url===t.scopeUrl)for(;WaspUI.unhideTreeNode(t.url,"url"););}WaspUI.saveBypasses(),WaspUI.sizeConnectors(),this.events.onCancelClick.call(this,e)},onDurationChange:function(e){var s=this.parentNode,t=s.querySelector('[name="always"]');if(t){var i=t.parentNode,n=s.querySelector('[name="overrideUrl"]');"0"==this.value?(t.disabled=!0,i.classList.add("disabled"),n&&(n.disabled=!0)):"1"==this.value?(t.disabled=!0,i.classList.add("disabled"),n&&(n.disabled=!1)):(t.disabled=!1,i.classList.remove("disabled"),n&&(n.disabled=!1))}}}};WebInspector.StatusBarItem=function(e){this.element=e,this._enabled=!0},WebInspector.StatusBarItem.prototype={setEnabled:function(e){this._enabled!==e&&(this._enabled=e,this._applyEnabledState())},_applyEnabledState:function(){this.element.disabled=!this._enabled},__proto__:Object.prototype},WebInspector.StatusBarButton=function(e,t,s){WebInspector.StatusBarItem.call(this,document.createElement("button")),this.element.className=t+" status-bar-item",this.element.addEventListener("click",this._clicked.bind(this),!1),this.glyph=document.createElement("div"),this.glyph.className="glyph",this.element.appendChild(this.glyph),this.states=s,s||(this.states=2),this._state=2!=s&&0,this.title=e,this.className=t,this._visible=!0},WebInspector.StatusBarButton.prototype={_clicked:function(){this.dispatchEventToListeners("click"),this._showOptionsTimer&&clearTimeout(this._showOptionsTimer)},enabled:function(){return this._enabled},get title(){return this._title},set title(e){this._title!==e&&(this._title=e,this.element.title=e)},get state(){return this._state},set state(e){this._state!==e&&(2===this.states?this.element.enableStyleClass("toggled-on",e):(this.element.removeStyleClass("toggled-"+this._state),0!==e&&this.element.addStyleClass("toggled-"+e)),this._state=e)},get toggled(){if(2!==this.states)throw"Only used toggled when there are 2 states, otherwise, use state";return this.state},set toggled(e){if(2!==this.states)throw"Only used toggled when there are 2 states, otherwise, use state";this.state=e},get visible(){return this._visible},set visible(e){this._visible!==e&&(this.element.enableStyleClass("hidden",!e),this._visible=e)},makeLongClickEnabled:function(e){function t(e){1===e.which&&this._showOptionsTimer&&clearTimeout(this._showOptionsTimer)}this.longClickGlyph=document.createElement("div"),this.longClickGlyph.className="fill long-click-glyph",this.element.appendChild(this.longClickGlyph),this.longClickGlyphShadow=document.createElement("div"),this.longClickGlyphShadow.className="fill long-click-glyph shadow",this.element.appendChild(this.longClickGlyphShadow),this.element.addEventListener("mousedown",function(t){if(1!==t.which)return;this._showOptionsTimer=setTimeout(this._showOptions.bind(this,e),200)}.bind(this),!1),this.element.addEventListener("mouseout",t.bind(this),!1),this.element.addEventListener("mouseup",t.bind(this),!1)},_showOptions:function(e){var t=e(),s=new WebInspector.StatusBarButton(this.title,this.className,this.states);s.addEventListener("click",this._clicked,this),s.state=this.state,t.push(s);var i=function(e){if(1!==e.which)return;n.dispose(),document.documentElement.removeEventListener("mouseup",i,!1);for(var s=0;s<t.length;++s)t[s].element.hasStyleClass("emulate-active")&&t[s]._clicked()}.bind(this);document.documentElement.addEventListener("mouseup",i,!1);var n=new WebInspector.GlassPane,l=n.element.createChild("div","alternate-status-bar-buttons-bar");l.style.height=24*t.length+"px",l.style.left=this.element.offsetLeft+1+"px";for(var a=function(e){if(1!==e.which)return;e.target.enclosingNodeOrSelfWithClass("status-bar-item").addStyleClass("emulate-active")}.bind(this),h=function(e){if(1!==e.which)return;e.target.enclosingNodeOrSelfWithClass("status-bar-item").removeStyleClass("emulate-active")}.bind(this),o=0;o<t.length;++o)t[o].element.addEventListener("mousemove",a,!1),t[o].element.addEventListener("mouseout",h,!1),l.appendChild(t[o].element);t[t.length-1].element.addStyleClass("emulate-active")},__proto__:WebInspector.StatusBarItem.prototype},WebInspector.StatusBarComboBox=function(e,t){WebInspector.StatusBarItem.call(this,document.createElement("span")),this.element.className="status-bar-select-container",this._selectElement=this.element.createChild("select","status-bar-item"),e&&this._selectElement.addEventListener("change",e,!1),t&&this._selectElement.addStyleClass(t)},WebInspector.StatusBarComboBox.prototype={size:function(){return this._selectElement.childElementCount},addOption:function(e){this._selectElement.appendChild(e)},createOption:function(e,t,s){var i=this._selectElement.createChild("option");return i.text=e,t&&(i.title=t),void 0!==s&&(i.value=s),i},_applyEnabledState:function(){this._selectElement.disabled=!this._enabled},removeOption:function(e){this._selectElement.removeChild(e)},removeOptions:function(){this._selectElement.removeChildren()},selectedOption:function(){return this._selectElement.selectedIndex>=0?this._selectElement[this._selectElement.selectedIndex]:null},select:function(e){this._selectElement.selectedIndex=Array.prototype.indexOf.call(this._selectElement,e)},__proto__:WebInspector.StatusBarItem.prototype};WebInspector.SplitView=function(e,t,i,s){WebInspector.View.call(this,document.querySelector(".split-view")),this._firstElement=document.querySelector(".split-view-contents-first"),this._secondElement=document.querySelector(".split-view-contents-second"),this._resizerElement=document.querySelector(".split-view-resizer"),this.installResizer(this._resizerElement),this._resizable=!0,this._savedSidebarWidth=i||200,this._savedSidebarHeight=s||this._savedSidebarWidth,0<this._savedSidebarWidth&&this._savedSidebarWidth<1&&0<this._savedSidebarHeight&&this._savedSidebarHeight<1&&(this._useFraction=!0),this._sidebarSizeSettingName=t,this.setSecondIsSidebar(!0),this._innerSetVertical(e),this._updateLayout()},WebInspector.SplitView.prototype={isVertical:function(){return this._isVertical},setVertical:function(e){this._isVertical!==e&&(this._innerSetVertical(e),this.isShowing()&&this._updateLayout())},_innerSetVertical:function(e){this.element.removeStyleClass(this._isVertical?"split-view-vertical":"split-view-horizontal"),this._isVertical=e,this.element.addStyleClass(this._isVertical?"split-view-vertical":"split-view-horizontal")},_updateLayout:function(){this._updateTotalSize(),delete this._sidebarSize,this.setSidebarSize(this._lastSidebarSize())},firstElement:function(){return this._firstElement},secondElement:function(){return this._secondElement},get mainElement(){return this.isSidebarSecond()?this.firstElement():this.secondElement()},get sidebarElement(){return this.isSidebarSecond()?this.secondElement():this.firstElement()},isSidebarSecond:function(){return this._secondIsSidebar},setSecondIsSidebar:function(e){this.sidebarElement.removeStyleClass("split-view-sidebar"),this._secondIsSidebar=e,this.sidebarElement.addStyleClass("split-view-sidebar")},resizerElement:function(){return this._resizerElement},showOnlyFirst:function(){this._showOnly(this._firstElement,this._secondElement)},showOnlySecond:function(){this._showOnly(this._secondElement,this._firstElement)},_showOnly:function(e,t){e.removeStyleClass("hidden"),e.addStyleClass("maximized"),t.addStyleClass("hidden"),t.removeStyleClass("maximized"),this._removeAllLayoutProperties(),this._isShowingOne=!0,this.setResizable(!1),this.doResize()},_removeAllLayoutProperties:function(){this._firstElement.style.removeProperty("right"),this._firstElement.style.removeProperty("bottom"),this._firstElement.style.removeProperty("width"),this._firstElement.style.removeProperty("height"),this._secondElement.style.removeProperty("left"),this._secondElement.style.removeProperty("top"),this._secondElement.style.removeProperty("width"),this._secondElement.style.removeProperty("height"),this._resizerElement.style.removeProperty("left"),this._resizerElement.style.removeProperty("right"),this._resizerElement.style.removeProperty("top"),this._resizerElement.style.removeProperty("bottom"),this._resizerElement.style.removeProperty("margin-left"),this._resizerElement.style.removeProperty("margin-right"),this._resizerElement.style.removeProperty("margin-top"),this._resizerElement.style.removeProperty("margin-bottom")},showBoth:function(){this._isShowingOne=!1,this._firstElement.removeStyleClass("hidden"),this._firstElement.removeStyleClass("maximized"),this._secondElement.removeStyleClass("hidden"),this._secondElement.removeStyleClass("maximized"),this._updateLayout(),this.setResizable(!0),this.doResize()},setResizable:function(e){this._resizable!==e&&(this._resizable=e,e?this._resizerElement.removeStyleClass("hidden"):this._resizerElement.addStyleClass("hidden"))},setSidebarSize:function(e){this._sidebarSize!==e&&((e=this.applyConstraints(e))<0?this._sidebarSize=e:(this._innerSetSidebarSize(e),this._saveSidebarSize(e)))},sidebarSize:function(){return this._sidebarSize},totalSize:function(){return this._totalSize},_updateTotalSize:function(){this._totalSize=this._isVertical?this.element.offsetWidth:this.element.offsetHeight,this._useFraction&&(this._sidebarSize=this._lastSidebarSize())},_innerSetSidebarSize:function(e){if(!this._isShowingOne){var t;if(this._removeAllLayoutProperties(),t=this._useFraction?e/this._totalSize*100+"%":e+"px",this._isVertical){var i=this._resizerElement.offsetWidth;this._secondIsSidebar?(this._firstElement.style.right=t,this._secondElement.style.width=t,this._resizerElement.style.right=t,this._resizerElement.style.marginRight=-i/2+"px"):(this._firstElement.style.width=t,this._secondElement.style.left=t,this._resizerElement.style.left=t,this._resizerElement.style.marginLeft=-i/2+"px")}else{var s=this._resizerElement.offsetHeight;this._secondIsSidebar?(this._firstElement.style.bottom=t,this._secondElement.style.height=t,this._resizerElement.style.bottom=t,this._resizerElement.style.marginBottom=-s/2+"px"):(this._firstElement.style.height=t,this._secondElement.style.top=t,this._resizerElement.style.top=t,this._resizerElement.style.marginTop=-s/2+"px")}this._sidebarSize=e,this.doResize()}},applyConstraints:function(e){return e=Math.max(e,20),this._totalSize-e<20&&(e=this._totalSize-20),e<20?-1:e},wasShown:function(){this._updateLayout()},onResize:function(){this._sidebarSize<0?this._updateLayout():this._updateTotalSize()},_startResizerDragging:function(e){return!!this._resizable&&(this._dragOffset=(this._secondIsSidebar?this._totalSize-this._sidebarSize:this._sidebarSize)-(this._isVertical?e.pageX:e.pageY),!0)},_resizerDragging:function(e){var t=(this._isVertical?e.pageX:e.pageY)+this._dragOffset,i=this._secondIsSidebar?this._totalSize-t:t;this.setSidebarSize(i),e.preventDefault()},_endResizerDragging:function(e){delete this._dragOffset},installResizer:function(e){e.addEventListener("mousedown",this._onDragStart.bind(this),!1)},_onDragStart:function(e){WebInspector._elementDragStart(this._startResizerDragging.bind(this),this._resizerDragging.bind(this),this._endResizerDragging.bind(this),this._isVertical?"ew-resize":"ns-resize",e)},_sizeSetting:function(){if(!this._sidebarSizeSettingName)return null;var e=this._sidebarSizeSettingName+(this._isVertical?"":"H");return WebInspector.settings[e]||(WebInspector.settings[e]=WebInspector.settings.createSetting(e,void 0)),WebInspector.settings[e]},_lastSidebarSize:function(){var e=this._sizeSetting(),t=e?e.get():0;return t||(t=this._isVertical?this._savedSidebarWidth:this._savedSidebarHeight),this._useFraction&&(t*=this._totalSize),t},_saveSidebarSize:function(e){this._useFraction&&(e/=this._totalSize),this._isVertical?this._savedSidebarWidth=e:this._savedSidebarHeight=e;var t=this._sizeSetting();t&&t.set(e)},createButtonAndRegisterShortcuts:function(e,t,i,s){var n=new WebInspector.StatusBarButton(t,e);return n.element.addEventListener("click",i,!1),n.shortcuts=s,n},_updateButtonTitle:function(e,t){var i=e.shortcuts&&e.shortcuts.length;e.title=i?String.vsprintf(t,[e.shortcuts[0].name]):t},_shortcuts:{},registerShortcuts:function(e,t){for(var i=0;i<e.length;++i)this._shortcuts[e[i].key]=t},__proto__:WebInspector.View.prototype},WaspUI.SplitView=function(e,t,i,s){WebInspector.SplitView.call(this,e,t,i,s);var n=this.sidebarElement,r=n.toolbar=document.createElement("div");r.className="sidebar-pane-toolbar status-bar",r.id="wasp-sidebar-toolbar",n.appendChild(r),n.detailStack=new WebInspector.SidebarPaneStack("details"),n.contentStack=new WebInspector.SidebarPaneStack("content hidden"),n.appendChild(n.detailStack.element),n.appendChild(n.contentStack.element);var a=this.mainElement;a.contentPanels=[],a.currentContent=a.contentPanels[0]=new WaspUI.ContentPanel(a);for(var l=a.currentContent.element;a.firstElementChild;)l.appendChild(a.removeChild(a.firstElementChild));(r=a.toolbar=document.createElement("div")).className="main-pane-toolbar tabbed-pane-toolbar status-bar",r.id="wasp-main-toolbar",r.resizeThumb=document.createElement("div"),r.resizeThumb.id="WASP-sidebar-resizer-widget",this.installResizer(r.resizeThumb),r.appendChild(r.resizeThumb),a.appendChild(r),a.appendChild(l),a.tabBar=new WaspUI.TabBar(r),a.getNewContentPane=function(e){var t=this.tabBar.tabs.length,i=e.parseUrl().pathname.split("/"),s=i.pop();return""===s&&(s+=i.pop()+"/"),t?(this.currentContent=new WaspUI.ContentPanel(this,e),this.contentPanels.push(this.currentContent),this.appendChild(this.currentContent.element)):this.currentContent.url=e,this.tabBar.addTab(s,e,this.currentContent).focused=!0,this.currentContent}.bind(a)},WaspUI.SplitView.prototype={__proto__:WebInspector.SplitView.prototype},WaspUI.ContentPanel=function(e,t,i){this.mainPanel=e,this.tab=i,i&&(i.panel=this),this.element=document.createElement("div"),this.element.className="main-pane-content tabbed-pane-content",this.url=t,this.handle=WaspUI.ContentPanel.handle++,this.onRemove=function(e){return e},this.pageNode=void 0},WaspUI.ContentPanel.handle=1,WaspUI.ContentPanel.prototype={get url(){return this.element.dataset.url},set url(e){var t=(e+="").parseUrl(),i=t.hostname,s=t.hostname.split(".").reverse();this.element.dataset.url=e.split(/#|\?/)[0],s=i.match(/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/)?i.split("."):2==s[0].length&&s[1].length<=3?s.slice(0,3).reverse():s.slice(0,2).reverse(),this.element.dataset.domain=s.join(".")},get domain(){return this.element.dataset.domain},remove:function(e){if(this.mainPanel){var t=this.mainPanel.contentPanels,i=t.indexOf(this);-1!=i&&(t.splice(i,1),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element),delete this.element,delete this.mainPanel,e||this.tab.remove(!0),delete this.tab,this.onRemove(this))}},get focused(){return!this.element.classList.contains("hidden")},set focused(e){(e=!!e)!=!this.element.classList.contains("hidden")&&(e?(this.mainPanel.currentContent&&this.mainPanel.currentContent!=this&&(this.mainPanel.currentContent.focused=!1),this.element.classList.remove("hidden"),this.tab.focused=!0,this.mainPanel.currentContent=this,this.pageNode&&this.pageNode.click()):(this.element.classList.add("hidden"),this.tab.focused=!1,this.mainPanel.currentContent==this&&(this.mainPanel.currentContent=null)))},get nextPanel(){var e=this.mainPanel.contentPanels,t=e.indexOf(this);return++t?t==e.length?e[0]:e[t]:null},get previousPanel(){var e=this.mainPanel.contentPanels,t=e.indexOf(this);return-1!=t?0==t?e[e.length-1]:e[--t]:null}},WaspUI.Tab=function(e,t,i,s){this.tabBar=i,i.tabs.push(this),this.panel=s,s&&(s.tab=this);var n=this.element=document.createElement("li");n.addEventListener("click",this.eventHandlers.onClick.bind(this)),n.className="tab",n.innerText=e,n.title=t,i.innerElement.appendChild(this.element)},WaspUI.Tab.prototype={remove:function(e){if(this.tabBar){var t=this.tabBar.tabs,i=t.indexOf(this);-1!=i&&(t.splice(i,1),this.element&&this.element.parentElement&&this.element.parentElement.removeChild(this.element),delete this.tabBar,delete this.closeButton,delete this.element,e||this.panel.remove(!0),delete this.panel)}},eventHandlers:{onClick:function(e){this.focused=!0},onClose:function(e){this.remove()},onEnter:function(e){this.highlighted=!0},onLeave:function(e){this.highlighted=!1}},get highlighted(){return this.element.classList.contains("highlight")},set highlighted(e){e?this.element.classList.contains("highlight"):this.element.classList.remove("highlight")},get focused(){return this.element.classList.contains("focus")},set focused(e){(e=!!e)!=this.element.classList.contains("focus")&&(e?(this.tabBar.currentTab&&this.tabBar.currentTab!=this&&(this.tabBar.currentTab.focused=!1),this.element.classList.add("focus"),this.panel.focused=!0,this.tabBar.currentTab=this,this.scrollIntoView()):(this.element.classList.remove("focus"),this.panel.focused=!1,this.tabBar.currentTab==this&&(this.tabBar.currentTab=null)))},scrollIntoView:function(){this.tabBar.scrollTabsTo(this.element.offsetLeft,this.element.offsetWidth)},get nextTab(){var e=this.tabBar.tabs,t=e.indexOf(this);return++t?t==e.length?e[0]:e[t]:null},get previousTab(){var e=this.tabBar.tabs,t=e.indexOf(this);return-1!=t?0==t?e[e.length-1]:e[--t]:null}},WaspUI.TabBar=function(e){this.outerElement=document.createElement("div"),this.outerElement.className="tab-container-outer",this.innerElement=document.createElement("ul"),this.innerElement.className="tab-container-inner",this.innerElement.style.left="0px",this.outerElement.appendChild(this.innerElement),this.leftScroller=new WebInspector.StatusBarButton("Scroll Tabs","WASP-scroll-button-left",1),this.leftScroller.element.classList.add("hidden"),this.rightScroller=new WebInspector.StatusBarButton("Scroll Tabs","WASP-scroll-button-right",1),this.rightScroller.element.classList.add("hidden"),this.tabs=[],this.currentTab=null,e.appendChild(this.leftScroller.element),e.appendChild(this.outerElement),e.appendChild(this.rightScroller.element)},WaspUI.TabBar.prototype={addTab:function(e,t,i){for(;this.tabs.length>=5;)this.tabs[0].remove();return new WaspUI.Tab(e,t,this,i)},scrollTabsTo:function(e,t){if(!isNaN(e)){var i=this.viewport;t=isNaN(t)?0:Math.max(0,Math.min(t,i.offset));var s=(e=Math.max(0,Math.min(e,i.right+i.offset-t)))+t,n=-i.left;i.left-e<0?n+=e:i.offset&&s>i.right&&(n+=i.right-s),this.innerElement.style.left=(n<0?n:0)+"px"}},scrollTabsBy:function(e){if(!isNaN(e)&&e){var t=this.viewport,i=-t.left,s=0;e<0&&t.offest>0?s=Math.max(i+e,-t.offset):e>0&&t.left<0&&(s=Math.min(i+e,0)),this.innerElement.style.left=s+"px"}},get viewport(){var e=parseInt(this.innerElement.style.left),t=this.innerElement.offsetWidth,i=this.outerElement.offsetWidth-e;return{top:0,left:-e,right:t>i?i:t,bottom:this.innerElement.offsetHeight,offset:t>i?t-i:0}}};WebInspector.SidebarPane=function(e){WebInspector.View.call(this),this.element.className="sidebar-pane",this.titleElement=document.createElement("div"),this.titleElement.className="sidebar-pane-toolbar",this.bodyElement=this.element.createChild("div","body"),this._title=e,this._expandCallback=null},WebInspector.SidebarPane.EventTypes={wasShown:"wasShown"},WebInspector.SidebarPane.prototype={title:function(){return this._title},prepareContent:function(e){e&&e()},expand:function(){this.prepareContent(this.onContentReady.bind(this))},onContentReady:function(){this._expandCallback?this._expandCallback():this._expandPending=!0},setExpandCallback:function(e){this._expandCallback=e,this._expandPending&&(delete this._expandPending,this._expandCallback())},wasShown:function(){WebInspector.View.prototype.wasShown.call(this),this.dispatchEventToListeners(WebInspector.SidebarPane.EventTypes.wasShown)},__proto__:WebInspector.View.prototype},WebInspector.SidebarPaneTitle=function(e,t,n){this._pane=t,this.element=e.createChild("div","sidebar-pane-title"),this.element.textContent=t.title(),this.element.tabIndex=0,this.element.addEventListener("click",this._toggleExpanded.bind(this),!1),this._pane._onTitleClick&&this.element.addEventListener("click",this._pane._onTitleClick.bind(this._pane)),this.element.addEventListener("keydown",this._onTitleKeyDown.bind(this),!1),n&&[].indexOf.call(this.elements.childNodes,n)>-1?this.element.ionsertBefore(this._pane.titleElement,n):this.element.appendChild(this._pane.titleElement),this._pane.setExpandCallback(this._expand.bind(this))},WebInspector.SidebarPaneTitle.prototype={_expand:function(){this.element.addStyleClass("expanded"),this._pane.show(this.element.parentNode,this.element.nextSibling)},_collapse:function(){this.element.removeStyleClass("expanded"),this._pane.element.parentNode==this.element.parentNode&&this._pane.detach()},_toggleExpanded:function(){this.element.hasStyleClass("expanded")?this._collapse():this._pane.expand()},_onTitleKeyDown:function(e){(isEnterKey(e)||e.keyCode===WebInspector.KeyboardShortcut.Keys.Space.code)&&this._toggleExpanded()}},WebInspector.SidebarPaneStack=function(e){WebInspector.View.call(this),this.element.className="sidebar-pane-stack fill "+(e||""),this.panes=[]},WebInspector.SidebarPaneStack.prototype={addPane:function(e,t){return t&&t.titleElement?new WebInspector.SidebarPaneTitle(this.element,e,t):new WebInspector.SidebarPaneTitle(this.element,e),this.panes.push(e),this.panes.length-1},clearPanes:function(){for(var e=this.element,t=e.children.length;t--;)e.removeChild(e.children[t]);this.panes=[]},__proto__:WebInspector.View.prototype},WaspUI.SidebarPane=function(e,t,n){WebInspector.SidebarPane.call(this,e),this.element.id=t,this._expanded="true"===String(WaspUI.settings.get("pane-"+t+"-expanded",n)),this.titleElement.addEventListener("mouseup",this._onTitleClick.bind(this)),this._expanded&&this.expand()},WaspUI.SidebarPane.prototype={sections:[],_onTitleClick:function(e){this._expanded=!this._expanded,WaspUI.settings.set("pane-"+this.element.id+"-expanded",this._expanded)},addPropertiesSection:function(e,t){var n=new WaspUI.PropertiesSection(e,t);return this.sections.push(n),this.bodyElement.appendChild(n.element),n},addPropertiesSectionsFromArray:function(e,t,n,i,s){for(var a,d="",o=-1,l=e.length;++o<l;){var p=e[o];p[t]!==d&&(d=p[t],a=this.addPropertiesSection(d,s)),a.addProperty(p[n],p[i])}},addCodeViewSection:function(e,t){var n=new WaspUI.CodeViewSection(e);return n.element.id=t,this.sections.push(n),this.bodyElement.appendChild(n.element),n},addEmptySection:function(e,t){var n=new WaspUI.EmptySection(e);return t&&(n.element.id=t),this.sections.push(n),this.bodyElement.appendChild(n.element),n},addImageSection:function(e,t){var n=new WaspUI.ImageSection(e);return t&&(n.element.id=t),this.sections.push(n),this.bodyElement.appendChild(n.element),n},__proto__:WebInspector.SidebarPane.prototype};WebInspector.Section=function(e,t){this.element=document.createElement("div"),this.element.className="section",this.element._section=this,this.headerElement=document.createElement("div"),this.headerElement.className="header",this.titleElement=document.createElement("div"),this.titleElement.className="title",this.subtitleElement=document.createElement("div"),this.subtitleElement.className="subtitle",this.headerElement.appendChild(this.subtitleElement),this.headerElement.appendChild(this.titleElement),this.headerElement.addEventListener("click",this.handleClick.bind(this),!1),this.element.appendChild(this.headerElement),this.title=e,this.subtitle=t,this._expanded=!1},WebInspector.Section.prototype={get title(){return this._title},set title(e){this._title!==e&&(this._title=e,e instanceof Node?(this.titleElement.removeChildren(),this.titleElement.appendChild(e)):this.titleElement.textContent=e)},get subtitle(){return this._subtitle},set subtitle(e){this._subtitle!==e&&(this._subtitle=e,this.subtitleElement.textContent=e)},get subtitleAsTextForTest(){var e=this.subtitleElement.textContent,t=this.subtitleElement.querySelector("[data-uncopyable]");if(t){var n=t.getAttribute("data-uncopyable");n&&(e+=n)}return e},get expanded(){return this._expanded},set expanded(e){e?this.expand():this.collapse()},get populated(){return this._populated},set populated(e){this._populated=e,!e&&this._expanded&&(this.onpopulate(),this._populated=!0)},onpopulate:function(){},get firstSibling(){var e=this.element.parentElement;if(!e)return null;for(var t=e.firstChild;t;){if(t._section)return t._section;t=t.nextSibling}return null},get lastSibling(){var e=this.element.parentElement;if(!e)return null;for(var t=e.lastChild;t;){if(t._section)return t._section;t=t.previousSibling}return null},get nextSibling(){var e=this.element;do{e=e.nextSibling}while(e&&!e._section);return e?e._section:null},get previousSibling(){var e=this.element;do{e=e.previousSibling}while(e&&!e._section);return e?e._section:null},expand:function(){this._expanded||(this._expanded=!0,this.element.addStyleClass("expanded"),this._populated||(this.onpopulate(),this._populated=!0))},collapse:function(){this._expanded&&(this._expanded=!1,this.element.removeStyleClass("expanded"))},toggleExpanded:function(){this.expanded=!this.expanded},handleClick:function(e){this.toggleExpanded(),e.consume()}},WaspUI.PropertiesSection=function(e,t){var n=t?0:"";WebInspector.Section.call(this,e,n),this.headerElement.addStyleClass("monospace"),this.propertiesElement=document.createElement("ol"),this.propertiesElement.className="properties properties-tree monospace",this.propertiesTreeOutline=new TreeOutline(this.propertiesElement,!0),this.propertiesTreeOutline.setFocusable(!1),this.propertiesTreeOutline.section=this,this.element.appendChild(this.propertiesElement),this.propertyCount=t?0:-1,this.copyText="",this.headerElement.addEventListener("contextmenu",this._onContextMenu.bind(this),!1)},WaspUI.PropertiesSection.prototype={addProperty:function(e,t,n,i){t=unescape(unescape(t));var s=new WaspUI.PropertyTreeElement(e,t,n);this.copyText+=e+"="+t+"\n",this.propertiesTreeOutline.appendChild(s),this.subtitle=this.propertyCount>=0?++this.propertyCount:"",i||this.expand()},addSimpleProperty:function(e,t,n){e=unescape(unescape(e));var i=new WaspUI.SimpleTreeElement(e,t);this.copyText+=e+"\n",this.propertiesTreeOutline.appendChild(i),this.subtitle=this.propertyCount>=0?++this.propertyCount:"",n||this.expand()},addPropertiesFromArray:function(e,t,n,i,s){for(var l=-1,r=e.length;++l<r;){var o=e[l];this.addProperty(o[t],o[n],i,s)}},addSimplePropertiesFromArray:function(e,t,n){for(var i=-1,s=e.length;++i<s;){var l=e[i];this.addSimpleProperty(l,t,n)}},addPropertiesFromQuerystring:function(e,t){if(e){0===e.indexOf("?")&&(e=e.substr(1));for(var n=e.split("&"),i=[],s=-1,l=n.length;++s<l;)2===(i=n[s].split("=")).length?this.addProperty(i[0],i[1],!1,t):this.addSimpleProperty(n[s],!0,t);n.length<=1&&i.length<=1&&this.addSimpleProperty("text",e,t)}},_onContextMenu:function(e){if(this.copyText.length){var t=new WebInspector.ContextMenu(e);t.appendItem("Copy all to Clipboard",function(){copyToClipboard(this.copyText)}.bind(this)),t.show()}},__proto__:WebInspector.Section.prototype},WaspUI.PropertyTreeElement=function(e,t,n){this.property={name:e,value:t,extended:!!n},TreeElement.call(this,"",null,!1),this.toggleOnClick=!0,this.selectable=!1},WaspUI.PropertyTreeElement.prototype={onattach:function(){this.update()},update:function(){this.nameElement=document.createElement("span"),this.nameElement.className="name",this.nameElement.textContent=this.property.name,this.property.enumerable||this.nameElement.addStyleClass("dimmed");var e=document.createElement("span");e.className="separator",e.textContent=": ",this.valueElement=document.createElement("span"),this.property.extended?(this.valueElement.className="value extended",this.valueElement.textContent="<br>"+this.property.value):(this.valueElement.className="value",this.valueElement.textContent=this.property.value),this.listItemElement.appendChild(this.nameElement),this.listItemElement.appendChild(e),this.listItemElement.appendChild(this.valueElement),this.hasChildren=this.property.value.hasChildren,this.listItemElement.addEventListener("contextmenu",this._onContextMenu.bind(this),!1)},_onContextMenu:function(e){var t=new WebInspector.ContextMenu(e);t.appendItem("Copy to Clipboard",function(){copyToClipboard(this.property.name+"="+this.property.value)}.bind(this)),t.show()},__proto__:TreeElement.prototype},WaspUI.SimpleTreeElement=function(e,t){this.property={value:e,extended:!!t},TreeElement.call(this,e,null,!1),this.toggleOnClick=!0,this.selectable=!1},WaspUI.SimpleTreeElement.prototype={onattach:function(){this.update()},update:function(){this.property.extended&&(this.listItemElement.classname+=" extended"),this.hasChildren=!1},__proto__:TreeElement.prototype},WaspUI.CodeViewSection=function(e){this.element=document.createElement("pre"),this.element.className="properties-code monospace",e&&this.appendContent(e)},WaspUI.CodeViewSection.prototype={appendContent:function(e){var t,n,i=e.split("\n"),s=this.element,l=document.createDocumentFragment();s.classList.remove("ldig"+s.childElementCount.toString().length);for(var r=-1,o=i.length;++r<o;)t=i[r],(n=document.createElement("span")).textContent=t+" ",l.appendChild(n);s.appendChild(l),s.classList.add("ldig"+s.childElementCount.toString().length)},clearContent:function(){for(var e=this.codeElement;e.lastChild;)e.removeChild(e.lastChild)}},WaspUI.EmptySection=function(e){this.element=document.createElement("p"),this.element.className="properties-empty",e&&(this.element.innerHTML=e)},WaspUI.ImageSection=function(e){this.element=document.createElement("p"),this.element.className="properties-image",this.element.innerHTML='Image:<br><img src="'+e+'">'};WaspUI.addNodeFavicon=function(e){try{var t=this.querySelector("label");t||(t=this.querySelector("span")),t.style.backgroundImage="url("+this.favicon.src+")"}catch(e){}},WaspUI.addDefaultFavicon=function(e){try{var t=this.favicon=new Image;t.onload=WaspUI.addNodeFavicon.bind(this),t.src="http://"+this.outerHTML.match(/data-domain="([^"]+)"/)[1]+"/favicon.ico"}catch(e){}},WaspUI.addDomainInfo=function(e){this.description="(no description available)",WaspUI.addDefaultFavicon.call(this)},WaspUI.createRequestNode=function(e,t,a,s){var n,r,i,o=e.hostname,d=e.href.split("#")[0],l=e.hostname.split(".").reverse(),p=WaspUI.mainPanel.currentContent;o?(n=(l=o.match(/(?:[0-9]{1,3}\.){3}[0-9]{1,3}/)?o.split("."):2==l[0].length&&l[1].length<=3?l.slice(0,3).reverse():l.slice(0,2).reverse()).join("_"),e.hostname=l.join(".")):(o=l=e.hostname=e.protocol,n=l.split("").pop().join("")),t.branches&&t.branches[n]?r=t.branches[n]:((r=t.addBranch(n,e.hostname)).classList.add("domain"),r.subdomains={},r.dataset.domain=r.hostname=e.hostname,WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,e.hostname,WaspUI.BYPASS_SCOPE_ALL).length?WaspUI.hideTreeNode(r,e.hostname,"domain"):WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,e.hostname,WaspUI.BYPASS_SCOPE_DOMAIN,p.domain).length?WaspUI.hideTreeNode(r,e.hostname,"domain"):WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,e.hostname,WaspUI.BYPASS_SCOPE_PAGE,p.url).length&&WaspUI.hideTreeNode(r,e.hostname,"domain"),WaspUI.addDomainInfo.call(r)),r.subdomains[o]||(r.subdomains[o]=!0,r.setAttribute("title",(i=r.getAttribute("title"))?i+="\n"+o:o));var c,h=e.pathname.split("/");return""===(c=h.pop())&&(c+=h.pop()+"/"),r=r.addBranch(e.pathname.replace(/[^a-zA-Z0-9]/g,"_"),c,!0),"Marketer"===WaspUI.displayType&&1==t.branches[n].branchIds.length?r.controller.uncheck():"Analyst"===WaspUI.displayType&&t.id.match(/^scripts/)&&1==t.branches[n].branchIds.length&&r.controller.uncheck(),r.setAttribute("title","right click for more options"),r.dataset.url=d,r.dataset.domain=e.hostname,r.dataset.name=c,WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,d,WaspUI.BYPASS_SCOPE_ALL).length?WaspUI.hideTreeNode(r,d,"url"):WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,d,WaspUI.BYPASS_SCOPE_DOMAIN,p.domain).length?WaspUI.hideTreeNode(r,d,"url"):WaspUI.getBypasses(WaspUI.BYPASS_TYPE_HIDE,d,WaspUI.BYPASS_SCOPE_PAGE,p.url).length&&WaspUI.hideTreeNode(r,d,"url"),r.addEventListener("click",a.bind(r),!1),s?r.addEventListener("contextmenu",s.bind(r),!1):r.addEventListener("contextmenu",WaspUI.events.onRequestNodeContextMenu.bind(r),!1),r.domainNode=t.branches[n],WaspUI.sizeConnectors(),r},WaspUI.makeNodeFriendly=function(e){var t=WaspUI.friendly.findGroup(e.dataset.domain,e.dataset.name,e.dataset.url),a=e.harObject;if(t.version){var s,n=t.classTag;if(n){for(var r=a.request.queryString.length;r--;)if(a.request.queryString[r].name==n){s=a.request.queryString[r].value,s=t.classMap&&t.classMap[s]||s;break}s||(s=t.class)}else t.class&&(s=t.class);s?(e.classList.add("friendly-"+s),e.title=t.title+" ["+s+"]\n"+e.title):e.title=t.title+"\n"+e.title}},WaspUI.events||(WaspUI.events={}),WaspUI.events.selectedNode=void 0,WaspUI.events.buildGeneralProperties=function(e){var t=WaspUI.sidebarPanel.detailStack,a=new WaspUI.SidebarPane("General Properties","general",!0);t.addPane(a);var s=a.addPropertiesSection("SEO Info",!0);s.addProperty("Title",e.title||"(undefined)"),s.addProperty("Description",e.description||"(undefined)"),s.addProperty("Keywords",e.keywords||"(undefined)")},WaspUI.events.buildRequestProperties=function(e){var t,a=e.request,s=e.dataset?e.dataset.url:null,n=WaspUI.sidebarPanel.detailStack,r=this.selectedNode.dataset,i=WaspUI.friendly.findGroup(r.domain,r.name,r.url);if(i.version){if(a.queryString.length)t=WaspUI.friendly.intersectTags(i.tags,a.queryString,"name","value",!0);else if(a.postData)if(a.postData.params)t=WaspUI.friendly.intersectTags(i.tags,a.postData.params,"name","value",!0);else{for(var o=[],d=a.postData.text.split("&"),l=-1,p=d.length;++l<p;){var c=d[l].split("=");c.length>1&&o.push({name:c[0],value:c[1]})}t=WaspUI.friendly.intersectTags(i.tags,o,"name","value",!0)}if(t.length)t=t.multidimSort(["group","name"]),(u=new WaspUI.SidebarPane(i.title,"friendly-"+i.id,!0)).addPropertiesSectionsFromArray(t,"group","name","value"),n.addPane(u)}var h=Object.keys(WaspUI.friendly.cookieGroups);for(l=-1,p=h.length;++l<p;){var u;if(i=WaspUI.friendly.cookieGroups[h[l]],(t=WaspUI.friendly.intersectTags(i.cookies,a.cookies,"name","value")).length)t=t.multidimSort(["group","name"]),(u=new WaspUI.SidebarPane(i.title+" (cookies)","friendly-"+i.id+"-cookies",!0)).addPropertiesSectionsFromArray(t,"group","name","value"),n.addPane(u)}var I=new WaspUI.SidebarPane("Request Properties","request",!0);if(n.addPane(I),s){var U=WaspUI.scriptinfo.get(s);if(U){var v=I.addPropertiesSection("Tag Details",!1);v.addProperty("Location",U.location),v.addProperty("Async",U.async)}}a.queryString.length&&I.addPropertiesSection("GET vars",!0).addPropertiesFromArray(a.queryString,"name","value");if(a.postData){var W=I.addPropertiesSection("POST vars",!0);a.postData.params?W.addPropertiesFromArray(a.postData.params,"name","value"):W.addPropertiesFromQuerystring(a.postData.text)}I.addPropertiesSection("COOKIE vars",!0).addPropertiesFromArray(a.cookies,"name","value"),I.addPropertiesSection("HEADER vars",!0).addPropertiesFromArray(a.headers,"name","value",!1,!0);var m=a.url.parseUrl(),g=[m.protocol+"//"+m.hostname],f=m.pathname.split("/");for(l=0,p=f.length;++l<p;)p-l>=2&&"http"===f[l].substr(0,4)?g.push("/"+f[l]+"//"+f[l+=2]):g.push("/"+f[l]);m.hash&&g.push(m.hash),I.addPropertiesSection("URL path",!0).addSimplePropertiesFromArray(g)},WaspUI.events.buildResponseProperties=function(e){var t=e.response,a=WaspUI.sidebarPanel.detailStack,s=new WaspUI.SidebarPane("Response Properties","response",!1);a.addPane(s);var n=s.addPropertiesSection("Details",!1);n.addProperty("Mime Type",t.content.mimeType),n.addProperty("Status",t.status+" "+t.statusText),s.addPropertiesSection("COOKIE vars",!0).addPropertiesFromArray(t.cookies,"name","value");for(var r=s.addPropertiesSection("HEADER vars",!0),i=-1,o=t.headers.length;++i<o;){var d=t.headers[i];r.addProperty(d.name,d.value,!1,!0),"location"==d.name.toLowerCase()&&n.addProperty("Redirects To",d.value)}},WaspUI.events.buildContentSection=function(e){var t=e&&e.harContent,a=WaspUI.sidebarPanel.contentStack,s=new WaspUI.SidebarPane("Content","content",!0);if(a.addPane(s),t){var n=e.getAttribute("data-url")||e.harObject.request.url;s.addEmptySection('<a href="'+n+'" target="_blank">'+n+"</a>"),s.addCodeViewSection(t)}else s.addEmptySection("No content or binary file format")},WaspUI.events.contextMenuFunctions={hideNodeDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.url,!1)},hideDomainDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_HIDE,this.dataset.domain,!0)},blockNodeDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_BLOCK,this.dataset.url,!1)},overrideNodeDialog:function(){new WaspUI.BypassNodeDialog(this,WaspUI.BYPASS_TYPE_OVERRIDE,this.dataset.url,!1)},manageBypassDialog:function(){new WaspUI.ManageBypassesDialog}},WaspUI.events.onRequestNodeContextMenu=function(e){var t=new WebInspector.ContextMenu(e),a=0===this.id.indexOf("tags")?"tag":"script",s=WaspUI.events.contextMenuFunctions;t.appendItem("Hide this "+a,s.hideNodeDialog.bind(this)),this.classList.contains("blocked")||this.classList.contains("override")||(t.appendItem("Block this "+a,s.blockNodeDialog.bind(this)),"script"===a&&t.appendItem("Override this script",s.overrideNodeDialog.bind(this))),t.appendSeparator(),t.appendItem("Hide this domain",s.hideDomainDialog.bind(this)),t.appendItem("Manage bypasses",s.manageBypassDialog.bind(this)),t.show()},WaspUI.events.onPageInfoClick=function(e){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var t=this.harObject;ga("send","event","node","page",t.request.url.match(/https*:\/\/([^\/]+)/)[1]);var a=WaspUI.sidebarPanel.detailStack;a.clearPanes(),WaspUI.events.buildGeneralProperties(t),WaspUI.events.buildRequestProperties(t),WaspUI.events.buildResponseProperties(t),(a=WaspUI.sidebarPanel.contentStack).clearPanes(),WaspUI.events.buildContentSection(this)},WaspUI.events.onTagNodeClick=function(e){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var t=this.harObject;ga("send","event","node","tag",t.request.url.match(/https*:\/\/([^\/]+)/)[1]);var a=WaspUI.sidebarPanel.detailStack;a.clearPanes(),WaspUI.events.buildRequestProperties(t),WaspUI.events.buildResponseProperties(t),(a=WaspUI.sidebarPanel.contentStack).clearPanes(),WaspUI.events.buildContentSection(this)},WaspUI.events.onScriptNodeClick=function(e){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var t=this.harObject;ga("send","event","node","script",t.request.url.match(/https*:\/\/([^\/]+)/)[1]);var a=WaspUI.sidebarPanel.detailStack;a.clearPanes(),WaspUI.events.buildRequestProperties(t),WaspUI.events.buildResponseProperties(t),(a=WaspUI.sidebarPanel.contentStack).clearPanes(),WaspUI.events.buildContentSection(this)},WaspUI.events.onBlockedNodeContextMenu=function(e){var t=new WebInspector.ContextMenu(e),a=WaspUI.events.contextMenuFunctions;t.appendItem("Hide this item",a.hideNodeDialog.bind(this)),t.appendItem("Hide this domain",a.hideDomainDialog.bind(this)),t.appendItem("Manage bypasses",a.manageBypassDialog.bind(this)),t.show()},WaspUI.events.onBlockedNodeClick=function(e){var t=this.request;this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var a=WaspUI.sidebarPanel.detailStack;a.clearPanes();var s=new WaspUI.SidebarPane("Request Properties","request",!0);a.addPane(s),s.addPropertiesSection("GET vars",!0).addPropertiesFromQuerystring(t.search);for(var n=[t.protocol+"//"+t.hostname],r=t.pathname.split("/"),i=0,o=r.length;++i<o;)o-i>=2&&"http"===r[i].substr(0,4)?n.push("/"+r[i]+"//"+r[i+=2]):n.push("/"+r[i]);t.hash&&n.push(t.hash),s.addPropertiesSection("URL path",!0).addSimplePropertiesFromArray(n),(a=WaspUI.sidebarPanel.contentStack).clearPanes(),WaspUI.events.buildContentSection(!1)},WaspUI.events.onDataLayerNodeClick=function(e){this.showConnections(!0),WaspUI.events.selectedNode&&WaspUI.events.selectedNode.classList.remove("selected"),WaspUI.events.selectedNode=this,this.classList.add("selected");var t=WaspUI.sidebarPanel.detailStack;t.clearPanes();var a=new WaspUI.SidebarPane("dataLayer Item","datalayer",!0);t.addPane(a),a.addPropertiesSection("Details",!0).addPropertiesFromArray(this.item,"name","value")},WaspUI.ContentChecker=function(e,t,a,s,n){this.r=e,this.root=t,this.event=a,this.altRoot=s,this.altEvent=n,this.i=WaspUI.ContentChecker.idgen++,WaspUI.ContentChecker.instances[this.i]=this},WaspUI.ContentChecker.instances={},WaspUI.ContentChecker.idgen=0,WaspUI.checkMainPageContent=function(e,t){this.r.request;var a=this.root;a.addEventListener("click",this.event.bind(a)),a.harObject=this.r,a.harContent=e,(n=e.match(/<(?:title)[^>]*>([^<]+)/))&&(this.r.title=n[1]);var s=e.match(/<(?:meta|link)[^>]*>/g);if(s){var n,r=document.createElement("head");if(r.insertAdjacentHTML("afterbegin",s.join("")),(n=r.querySelector('meta[name="description"]'))&&(this.r.description=a.description=n.getAttribute("content")),(n=r.querySelector('meta[name="keywords"]'))&&(this.r.keywords=a.keywords=n.getAttribute("content")),n=r.querySelector('link[rel*="icon"]'))if(a.favicon={},a.favicon=new Image,a.favicon.onerror=WaspUI.addDefaultFavicon.bind(this),a.favicon.onload=WaspUI.addNodeFavicon.bind(this),/^http/.test(n.getAttribute("href")))a.favicon.src=n.getAttribute("href");else{var i=document.createElement("A");i.href=a.harObject.request.url,a.favicon.src=i.origin+n.getAttribute("href")}else WaspUI.addDefaultFavicon.call(this)}this.event.call(a),delete WaspUI.ContentChecker.instances[this.i]},WaspUI.checkHTMLContent=function(e,t){var a=this.r.request;if(e){var s=e.match(/<(script|img|iframe)[^>]*>/g)||[];if(s.length){for(var n=s.length;n--;){var r=!!(s[n].match(/^<script/)||[]).length,i=(s[n].match(/src="([^"]+)"/i)||["",""])[1];if(i){var o=WaspUI.connections.add(a.url,i.parseUrl(a.url));r&&WaspUI.scriptinfo.set(!0,o.to,"IFRAME",!!s[n].match(/async/))}}(d=WaspUI.createRequestNode(a.url.parseUrl(),this.root,this.event)).classList.add("html"),d.harObject=this.r,d.harContent=e,d.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(d)}else{(d=WaspUI.createRequestNode(a.url.parseUrl(),this.altRoot,this.altEvent)).harObject=this.r,d.harContent=e,d.classList.add("other"),d.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(d)}}else{var d;(d=WaspUI.createRequestNode(a.url.parseUrl(),this.altRoot,this.altEvent)).harObject=this.r,d.classList.add("empty-html"),d.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(d)}delete WaspUI.ContentChecker.instances[this.i]},WaspUI.checkTextContent=function(e,t){var a=this.r.request,s=this.r.response.content.mimeType;if(e)if(s.match(/(?:javascript|json)/)||e.match(/function[^(]*\([^)]*\)/))WaspUI.scriptinfo.set(!1,a.url.split(/(\?|#)/)[0],"INJECT","unknown"),(n=WaspUI.createRequestNode(a.url.parseUrl(),this.root,this.event)).classList.add(),n.harObject=this.r,n.harContent=e,n.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(n);else if(e.match(/<(html|head|body)[^>]*>/))WaspUI.checkHTMLContent.call(this,e,t);else{var n;(n=WaspUI.createRequestNode(a.url.parseUrl(),this.altRoot,this.altEvent)).harObject=this.r,n.harContent=e,n.classList.add("other"),n.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(n)}else(n=WaspUI.createRequestNode(a.url.parseUrl(),this.altRoot,this.altEvent)).harObject=this.r,n.classList.add("empty-text"),n.classList.add("status"+this.r.response.status),WaspUI.makeNodeFriendly(n);delete WaspUI.ContentChecker.instances[this.i]},WaspUI.insertRequestNode=function(e){var t=WaspUI.mainPanel.rootnode;if(t){var a=t.tags,s=t.scripts,n=e.request,r=(i=e.response).content.mimeType;if(n.url!=t.pageInfo.url||t.pageInfo.harObject){var i,o=t.pageInfo.url.parseUrl().host,d=(n=e.request,r=(i=e.response).content.mimeType,n.url.parseUrl()),l=void 0;if(Number(i.status).toString().match(/30[12378]/)){for(var p=-1,c=i.headers.length;++p<c;){var h=i.headers[p];"location"==h.name.toLowerCase()&&WaspUI.connections.add(d.href,h.value)}(l=WaspUI.createRequestNode(d,a,WaspUI.events.onTagNodeClick)).classList.add("redirect")}else/(?:javascript|json)/.test(r)?s.querySelector('li[data-url="'+d.href+'"]')||e.getContent(WaspUI.checkTextContent.bind(new WaspUI.ContentChecker(e,s,WaspUI.events.onScriptNodeClick,a,WaspUI.events.onTagNodeClick))):/html/.test(r)?404!=Number(i.status)&&e.getContent(WaspUI.checkHTMLContent.bind(new WaspUI.ContentChecker(e,s,WaspUI.events.onScriptNodeClick,a,WaspUI.events.onTagNodeClick))):!/(css|javascript)/.test(r)&&d.host!==o&&("GET"===n.method&&n.queryString.length||"POST"===n.method||n.cookies.length)&&(/image/.test(r)?l=WaspUI.createRequestNode(d,a,WaspUI.events.onTagNodeClick):e.getContent(WaspUI.checkTextContent.bind(new WaspUI.ContentChecker(e,s,WaspUI.events.onScriptNodeClick,a,WaspUI.events.onTagNodeClick))));l&&(l.harObject=e,l.classList.add("status"+i.status),WaspUI.makeNodeFriendly(l))}else e.getContent(WaspUI.checkMainPageContent.bind(new WaspUI.ContentChecker(e,t.pageInfo,WaspUI.events.onPageInfoClick)))}},WaspUI.insertBlockedNode=function(e){e=e.parseUrl();var t=WaspUI.mainPanel.rootnode;t.blocked||(t.blocked=t.addBranch("blocked-"+WaspUI.mainPanel.currentContent.handle,"Blocked",!0,t.tags)),WaspUI.createRequestNode(e,t.blocked,WaspUI.events.onBlockedNodeClick,WaspUI.events.onBlockedNodeContextMenu).request=e},WaspUI.insertOverrideNode=function(e){e=e.parseUrl();var t=WaspUI.mainPanel.rootnode,a=WaspUI.createRequestNode(e,t.scripts,WaspUI.events.onBlockedNodeClick,WaspUI.events.onBlockedNodeContextMenu);a.classList.add("override"),a.request=e},WaspUI.insertDataLayerNode=function(e,t){var a=WaspUI.mainPanel.rootnode,s=!1;a.datalayer||(a.datalayer=a.addBranch("datalayer-"+WaspUI.mainPanel.currentContent.handle,t,!1,a.blocked||a.tags),"Marketer"===WaspUI.displayType&&WaspUI.hideTreeNode(a.datalayer,"tree","datalayer"),s=!0);t="item";for(var n=e.length;n--;)if(t=e[n].name,"event"==e[n].name){t=e[n].value;break}var r=a.datalayer.addBranch(Date.now(),t,!0);s&&r.controller.uncheck(),r.addEventListener("click",WaspUI.events.onDataLayerNodeClick.bind(r),!1),r.item=e},WaspUI.messages.addListener("url-override",function(e){WaspUI.insertOverrideNode(e.overrideCall,e.method,e.requestBody),WaspUI.connections.add(e.overrideCall,e.with)}),WaspUI.messages.addListener("url-block",function(e){WaspUI.insertBlockedNode(e.blockedCall,e.method,e.requestBody)}),WaspUI.messages.addListener("datalayer",function(e){for(var t=-1,a=e.items.length;++t<a;)WaspUI.insertDataLayerNode(e.items[t],e.for)}),WaspUI.messages.addListener("script-info",function(e){for(var t=e["script-info"],a=t.length;a--;){var s=t[a];WaspUI.scriptinfo.set(!0,s.src,s.location,s.async)}}),WaspUI.buildUI=function(e){WaspUI.displayType=localStorage.userType,WaspUI.viewController||WaspUI.initiatePanel(),WaspUI.browserTab!==chrome.devtools.inspectedWindow.tabId&&(WaspUI.messages.port.postMessage({"msg-type":"tab-tracking",stopTabTracking:WaspUI.browserTab}),WaspUI.browserTab=chrome.devtools.inspectedWindow.tabId),WaspUI.messages.port.postMessage({"msg-type":"tab-tracking",startTabTracking:WaspUI.browserTab});var t=WaspUI.mainPanel.getNewContentPane(e),a=t.element;if(wtree=WaspUI.mainPanel.rootnode=a.querySelector(".tree"))wtree.prune();else{for(;a.firstChild;)a.removeChild(a.firstChild);WaspUI.mainPanel.rootnode=wtree=WaspUI.addTree(a)}t.pageNode=wtree.pageInfo=wtree.addBranch("page-info-"+t.handle,"Page Info"),wtree.pageInfo.url=e.split("#")[0],wtree.tags=wtree.addBranch("tags-"+t.handle,"Tags",!0),wtree.scripts=wtree.addBranch("scripts-"+t.handle,"Scripts",!1)},chrome.devtools.network.onNavigated.addListener(WaspUI.buildUI),chrome.devtools.network.onRequestFinished.addListener(WaspUI.insertRequestNode),document.onreadystatechange=function(){if("interactive"==document.readyState){if(ga("send","pageview",{page:"/panel.html",title:"Panel"}),document.querySelector("#inner-reload-button").onclick=function(e){chrome.devtools.inspectedWindow.reload()},WaspUI.FATAL_ERROR){var e=new WebInspector.GlassPane,t=document.createElement("div");if(t.className="fatal",t.innerText=WaspUI.FATAL_ERROR.title,WaspUI.FATAL_ERROR.fix){t.appendChild(document.createElement("br"));var a=document.createElement("a");a.href=WaspUI.FATAL_ERROR.fix,a.innerText="Visit the WASP knowledge base to solve this issue.",a.onclick=function(){return WaspUI.messages.port.postMessage({"msg-type":"open-tab",uri:this.href}),!1},t.appendChild(a)}return void e.element.appendChild(t)}var s="";localStorage.panelOption&&localStorage.panelOption.length&&(s="&"+localStorage.panelOption,localStorage.panelOption=""),loadXHR("https://webanalyticssolutionprofiler.com/panel?v="+chrome.runtime.getManifest().version+s,!0,function(e){document.querySelector("#default-msg").innerHTML=e,document.querySelector("#inner-reload-button").onclick=function(e){chrome.devtools.inspectedWindow.reload()}})}};